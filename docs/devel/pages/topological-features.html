<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta name="generator" content="quarto-1.3.450">
<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">
<title>Orchestrating Hi-C analysis with Bioconductor - 7&nbsp; Finding topological features in Hi-C</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
  vertical-align: middle;
}
/* CSS for syntax highlighting */
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
  }
pre.numberSource { margin-left: 3em;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
/* CSS for citations */
div.csl-bib-body { }
div.csl-entry {
  clear: both;
}
.hanging-indent div.csl-entry {
  margin-left:2em;
  text-indent:-2em;
}
div.csl-left-margin {
  min-width:2em;
  float:left;
}
div.csl-right-inline {
  margin-left:2em;
  padding-left:1em;
}
div.csl-indent {
  margin-left: 2em;
}</style>

<script src="../site_libs/quarto-nav/quarto-nav.js"></script>
<script src="../site_libs/quarto-nav/headroom.min.js"></script>
<script src="../site_libs/clipboard/clipboard.min.js"></script>
<script src="../site_libs/quarto-search/autocomplete.umd.js"></script>
<script src="../site_libs/quarto-search/fuse.min.js"></script>
<script src="../site_libs/quarto-search/quarto-search.js"></script>
<meta name="quarto:offset" content="../">
<link href="../pages/disseminating.html" rel="next">
<link href="../pages/interactions-centric.html" rel="prev">
<link href="../assets/cover.jpg" rel="icon" type="image/jpeg">
<script src="../site_libs/quarto-html/quarto.js"></script>
<script src="../site_libs/quarto-html/popper.min.js"></script>
<script src="../site_libs/quarto-html/tippy.umd.min.js"></script>
<script src="../site_libs/quarto-html/anchor.min.js"></script>
<link href="../site_libs/quarto-html/tippy.css" rel="stylesheet">
<link href="../site_libs/quarto-html/quarto-syntax-highlighting.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="../site_libs/bootstrap/bootstrap.min.js"></script>
<link href="../site_libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="../site_libs/bootstrap/bootstrap.min.css" rel="stylesheet" id="quarto-bootstrap" data-mode="light"><script id="quarto-search-options" type="application/json">{
  "location": "sidebar",
  "copy-button": false,
  "collapse-after": 3,
  "panel-placement": "start",
  "type": "textbox",
  "limit": 20,
  "language": {
    "search-no-results-text": "No results",
    "search-matching-documents-text": "matching documents",
    "search-copy-link-title": "Copy link to search",
    "search-hide-matches-text": "Hide additional matches",
    "search-more-match-text": "more match in this document",
    "search-more-matches-text": "more matches in this document",
    "search-clear-button-title": "Clear",
    "search-detached-cancel-button-title": "Cancel",
    "search-submit-button-title": "Submit",
    "search-label": "Search"
  }
}</script>
</head>
<body class="nav-sidebar docked">

<div id="quarto-search-results"></div>
  <header id="quarto-header" class="headroom fixed-top"><nav class="quarto-secondary-nav"><div class="container-fluid d-flex">
      <button type="button" class="quarto-btn-toggle btn" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar,#quarto-sidebar-glass" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Toggle sidebar navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
        <i class="bi bi-layout-text-sidebar-reverse"></i>
      </button>
      <nav class="quarto-page-breadcrumbs" aria-label="breadcrumb"><ol class="breadcrumb"><li class="breadcrumb-item"><a href="../pages/matrix-centric.html">In-depth Hi-C analysis</a></li><li class="breadcrumb-item"><a href="../pages/topological-features.html"><span class="chapter-number">7</span>&nbsp; <span class="chapter-title">Finding topological features in Hi-C</span></a></li></ol></nav>
      <a class="flex-grow-1" role="button" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar,#quarto-sidebar-glass" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Toggle sidebar navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">      
      </a>
      <button type="button" class="btn quarto-search-button" aria-label="" onclick="window.quartoOpenSearch();">
        <i class="bi bi-search"></i>
      </button>
    </div>
  </nav></header><!-- content --><div id="quarto-content" class="quarto-container page-columns page-rows-contents page-layout-article">
<!-- sidebar -->
  <nav id="quarto-sidebar" class="sidebar collapse collapse-horizontal sidebar-navigation docked overflow-auto"><div class="pt-lg-2 mt-2 text-left sidebar-header">
    <div class="sidebar-title mb-0 py-0">
      <a href="../">Orchestrating Hi-C analysis with Bioconductor</a> 
        <div class="sidebar-tools-main">
    <div class="dropdown">
      <a href="" title="" id="quarto-navigation-tool-dropdown-0" class="quarto-navigation-tool dropdown-toggle px-1" data-bs-toggle="dropdown" aria-expanded="false" aria-label=""><i class="bi bi-git"></i></a>
      <ul class="dropdown-menu" aria-labelledby="quarto-navigation-tool-dropdown-0">
<li>
            <a class="dropdown-item sidebar-tools-main-item" href="https://github.com/js2264/OHCA/">
            Source Code
            </a>
          </li>
          <li>
            <a class="dropdown-item sidebar-tools-main-item" href="https://js2264.github.io/OHCA/devel/">
            Browse version `devel`
            </a>
          </li>
      </ul>
</div>
    <a href="../Orchestrating-Hi-C-analysis-with-Bioconductor.pdf" rel="" title="Download PDF" class="quarto-navigation-tool px-1" aria-label="Download PDF"><i class="bi bi-file-pdf"></i></a>
</div>
    </div>
      </div>
        <div class="mt-2 flex-shrink-0 align-items-center">
        <div class="sidebar-search">
        <div id="quarto-search" class="" title="Search"></div>
        </div>
        </div>
    <div class="sidebar-menu-container"> 
    <ul class="list-unstyled mt-1">
<li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../index.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Welcome</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../pages/preamble.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Preamble</span></a>
  </div>
</li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-1" aria-expanded="true">
 <span class="menu-text">Fundamentals concepts</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-1" aria-expanded="true" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-1" class="collapse list-unstyled sidebar-section depth1 show">
<li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../pages/principles.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">1</span>&nbsp; <span class="chapter-title">Hi-C pre-processing steps</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../pages/data-representation.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">2</span>&nbsp; <span class="chapter-title">Hi-C data structures in R</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../pages/parsing.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">3</span>&nbsp; <span class="chapter-title">Manipulating Hi-C data in R</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../pages/visualization.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">4</span>&nbsp; <span class="chapter-title">Hi-C data visualization</span></span></a>
  </div>
</li>
      </ul>
</li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-2" aria-expanded="true">
 <span class="menu-text">In-depth Hi-C analysis</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-2" aria-expanded="true" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-2" class="collapse list-unstyled sidebar-section depth1 show">
<li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../pages/matrix-centric.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">5</span>&nbsp; <span class="chapter-title">Matrix-centric analysis</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../pages/interactions-centric.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">6</span>&nbsp; <span class="chapter-title">Interactions-centric analysis</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../pages/topological-features.html" class="sidebar-item-text sidebar-link active">
 <span class="menu-text"><span class="chapter-number">7</span>&nbsp; <span class="chapter-title">Finding topological features in Hi-C</span></span></a>
  </div>
</li>
      </ul>
</li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-3" aria-expanded="true">
 <span class="menu-text">Advanced Hi-C topics</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-3" aria-expanded="true" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-3" class="collapse list-unstyled sidebar-section depth1 show">
<li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../pages/disseminating.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">8</span>&nbsp; <span class="chapter-title">Data gateways: accessing public Hi-C data portals</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../pages/interoperability.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">9</span>&nbsp; <span class="chapter-title">Interoperability: using HiCExperiment with other R packages</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../pages/workflow-yeast.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Workflow 1: Distance-dependent interactions across yeast mutants</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../pages/workflow-chicken.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Workflow 2: Chromosome compartment cohesion upon mitosis entry</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../pages/workflow-centros.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Workflow 3: Inter-centromere interactions in yeast</span></a>
  </div>
</li>
      </ul>
</li>
    </ul>
</div>
</nav><div id="quarto-sidebar-glass" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar,#quarto-sidebar-glass"></div>
<!-- margin-sidebar -->
    <div id="quarto-margin-sidebar" class="sidebar margin-sidebar">
        <nav id="TOC" role="doc-toc" class="toc-active"><h2 id="toc-title">Table of contents</h2>
   
  <ul>
<li>
<a href="#chromosome-compartments" id="toc-chromosome-compartments" class="nav-link active" data-scroll-target="#chromosome-compartments"><span class="header-section-number">7.1</span> Chromosome compartments</a>
  <ul class="collapse">
<li><a href="#importing-hi-c-data" id="toc-importing-hi-c-data" class="nav-link" data-scroll-target="#importing-hi-c-data"><span class="header-section-number">7.1.1</span> Importing Hi-C data</a></li>
  <li><a href="#annotating-ab-compartments" id="toc-annotating-ab-compartments" class="nav-link" data-scroll-target="#annotating-ab-compartments"><span class="header-section-number">7.1.2</span> Annotating A/B compartments</a></li>
  <li><a href="#exporting-compartment-tracks" id="toc-exporting-compartment-tracks" class="nav-link" data-scroll-target="#exporting-compartment-tracks"><span class="header-section-number">7.1.3</span> Exporting compartment tracks</a></li>
  <li><a href="#visualizing-compartment-tracks" id="toc-visualizing-compartment-tracks" class="nav-link" data-scroll-target="#visualizing-compartment-tracks"><span class="header-section-number">7.1.4</span> Visualizing compartment tracks</a></li>
  <li><a href="#saddle-plots" id="toc-saddle-plots" class="nav-link" data-scroll-target="#saddle-plots"><span class="header-section-number">7.1.5</span> Saddle plots</a></li>
  </ul>
</li>
  <li>
<a href="#topological-domains" id="toc-topological-domains" class="nav-link" data-scroll-target="#topological-domains"><span class="header-section-number">7.2</span> Topological domains</a>
  <ul class="collapse">
<li><a href="#computing-diamond-insulation-score" id="toc-computing-diamond-insulation-score" class="nav-link" data-scroll-target="#computing-diamond-insulation-score"><span class="header-section-number">7.2.1</span> Computing diamond insulation score</a></li>
  <li><a href="#exporting-insulation-scores-tracks" id="toc-exporting-insulation-scores-tracks" class="nav-link" data-scroll-target="#exporting-insulation-scores-tracks"><span class="header-section-number">7.2.2</span> Exporting insulation scores tracks</a></li>
  <li><a href="#visualizing-chromatin-domains" id="toc-visualizing-chromatin-domains" class="nav-link" data-scroll-target="#visualizing-chromatin-domains"><span class="header-section-number">7.2.3</span> Visualizing chromatin domains</a></li>
  </ul>
</li>
  <li>
<a href="#chromatin-loops" id="toc-chromatin-loops" class="nav-link" data-scroll-target="#chromatin-loops"><span class="header-section-number">7.3</span> Chromatin loops</a>
  <ul class="collapse">
<li><a href="#chromosight" id="toc-chromosight" class="nav-link" data-scroll-target="#chromosight"><span class="header-section-number">7.3.1</span> <code>chromosight</code></a></li>
  <li><a href="#other-r-packages" id="toc-other-r-packages" class="nav-link" data-scroll-target="#other-r-packages"><span class="header-section-number">7.3.2</span> Other R packages</a></li>
  </ul>
</li>
  <li><a href="#session-info" id="toc-session-info" class="nav-link" data-scroll-target="#session-info">Session info</a></li>
  <li><a href="#references" id="toc-references" class="nav-link" data-scroll-target="#references">References</a></li>
  </ul></nav>
    </div>
<!-- main -->
<main class="content" id="quarto-document-content"><header id="title-block-header" class="quarto-title-block default"><div class="quarto-title">
<h1 class="title">
<span class="chapter-number">7</span>&nbsp; <span class="chapter-title">Finding topological features in Hi-C</span>
</h1>
</div>



<div class="quarto-title-meta">

    
  
    
  </div>
  

</header><div class="callout callout-style-default callout-note callout-titled">
<div class="callout-header d-flex align-content-center" data-bs-toggle="collapse" data-bs-target=".callout-1-contents" aria-controls="callout-1" aria-expanded="false" aria-label="Toggle callout">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Pre-loading packages and objects 📦
</div>
<div class="callout-btn-toggle d-inline-block border-0 py-1 ps-1 pe-0 float-end"><i class="callout-toggle"></i></div>
</div>
<div id="callout-1" class="callout-1-contents callout-collapse collapse">
<div class="callout-body-container callout-body">
<div class="cell" data-layout-align="center">
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="https://dplyr.tidyverse.org">dplyr</a></span><span class="op">)</span></span>
<span><span class="co">##  </span></span>
<span><span class="co">##  Attaching package: 'dplyr'</span></span>
<span><span class="co">##  The following objects are masked from 'package:stats':</span></span>
<span><span class="co">##  </span></span>
<span><span class="co">##      filter, lag</span></span>
<span><span class="co">##  The following objects are masked from 'package:base':</span></span>
<span><span class="co">##  </span></span>
<span><span class="co">##      intersect, setdiff, setequal, union</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="https://ggplot2.tidyverse.org">ggplot2</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="https://bioconductor.org/packages/GenomicRanges">GenomicRanges</a></span><span class="op">)</span></span>
<span><span class="co">##  Loading required package: stats4</span></span>
<span><span class="co">##  Loading required package: BiocGenerics</span></span>
<span><span class="co">##  </span></span>
<span><span class="co">##  Attaching package: 'BiocGenerics'</span></span>
<span><span class="co">##  The following objects are masked from 'package:dplyr':</span></span>
<span><span class="co">##  </span></span>
<span><span class="co">##      combine, intersect, setdiff, union</span></span>
<span><span class="co">##  The following objects are masked from 'package:stats':</span></span>
<span><span class="co">##  </span></span>
<span><span class="co">##      IQR, mad, sd, var, xtabs</span></span>
<span><span class="co">##  The following objects are masked from 'package:base':</span></span>
<span><span class="co">##  </span></span>
<span><span class="co">##      Filter, Find, Map, Position, Reduce, anyDuplicated, aperm,</span></span>
<span><span class="co">##      append, as.data.frame, basename, cbind, colnames, dirname,</span></span>
<span><span class="co">##      do.call, duplicated, eval, evalq, get, grep, grepl, intersect,</span></span>
<span><span class="co">##      is.unsorted, lapply, mapply, match, mget, order, paste, pmax,</span></span>
<span><span class="co">##      pmax.int, pmin, pmin.int, rank, rbind, rownames, sapply,</span></span>
<span><span class="co">##      setdiff, table, tapply, union, unique, unsplit, which.max,</span></span>
<span><span class="co">##      which.min</span></span>
<span><span class="co">##  Loading required package: S4Vectors</span></span>
<span><span class="co">##  </span></span>
<span><span class="co">##  Attaching package: 'S4Vectors'</span></span>
<span><span class="co">##  The following objects are masked from 'package:dplyr':</span></span>
<span><span class="co">##  </span></span>
<span><span class="co">##      first, rename</span></span>
<span><span class="co">##  The following object is masked from 'package:utils':</span></span>
<span><span class="co">##  </span></span>
<span><span class="co">##      findMatches</span></span>
<span><span class="co">##  The following objects are masked from 'package:base':</span></span>
<span><span class="co">##  </span></span>
<span><span class="co">##      I, expand.grid, unname</span></span>
<span><span class="co">##  Loading required package: IRanges</span></span>
<span><span class="co">##  </span></span>
<span><span class="co">##  Attaching package: 'IRanges'</span></span>
<span><span class="co">##  The following objects are masked from 'package:dplyr':</span></span>
<span><span class="co">##  </span></span>
<span><span class="co">##      collapse, desc, slice</span></span>
<span><span class="co">##  Loading required package: GenomeInfoDb</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va">InteractionSet</span><span class="op">)</span></span>
<span><span class="co">##  Loading required package: SummarizedExperiment</span></span>
<span><span class="co">##  Loading required package: MatrixGenerics</span></span>
<span><span class="co">##  Loading required package: matrixStats</span></span>
<span><span class="co">##  </span></span>
<span><span class="co">##  Attaching package: 'matrixStats'</span></span>
<span><span class="co">##  The following object is masked from 'package:dplyr':</span></span>
<span><span class="co">##  </span></span>
<span><span class="co">##      count</span></span>
<span><span class="co">##  </span></span>
<span><span class="co">##  Attaching package: 'MatrixGenerics'</span></span>
<span><span class="co">##  The following objects are masked from 'package:matrixStats':</span></span>
<span><span class="co">##  </span></span>
<span><span class="co">##      colAlls, colAnyNAs, colAnys, colAvgsPerRowSet, colCollapse,</span></span>
<span><span class="co">##      colCounts, colCummaxs, colCummins, colCumprods, colCumsums,</span></span>
<span><span class="co">##      colDiffs, colIQRDiffs, colIQRs, colLogSumExps, colMadDiffs,</span></span>
<span><span class="co">##      colMads, colMaxs, colMeans2, colMedians, colMins, colOrderStats,</span></span>
<span><span class="co">##      colProds, colQuantiles, colRanges, colRanks, colSdDiffs, colSds,</span></span>
<span><span class="co">##      colSums2, colTabulates, colVarDiffs, colVars, colWeightedMads,</span></span>
<span><span class="co">##      colWeightedMeans, colWeightedMedians, colWeightedSds,</span></span>
<span><span class="co">##      colWeightedVars, rowAlls, rowAnyNAs, rowAnys, rowAvgsPerColSet,</span></span>
<span><span class="co">##      rowCollapse, rowCounts, rowCummaxs, rowCummins, rowCumprods,</span></span>
<span><span class="co">##      rowCumsums, rowDiffs, rowIQRDiffs, rowIQRs, rowLogSumExps,</span></span>
<span><span class="co">##      rowMadDiffs, rowMads, rowMaxs, rowMeans2, rowMedians, rowMins,</span></span>
<span><span class="co">##      rowOrderStats, rowProds, rowQuantiles, rowRanges, rowRanks,</span></span>
<span><span class="co">##      rowSdDiffs, rowSds, rowSums2, rowTabulates, rowVarDiffs,</span></span>
<span><span class="co">##      rowVars, rowWeightedMads, rowWeightedMeans, rowWeightedMedians,</span></span>
<span><span class="co">##      rowWeightedSds, rowWeightedVars</span></span>
<span><span class="co">##  Loading required package: Biobase</span></span>
<span><span class="co">##  Welcome to Bioconductor</span></span>
<span><span class="co">##  </span></span>
<span><span class="co">##      Vignettes contain introductory material; view with</span></span>
<span><span class="co">##      'browseVignettes()'. To cite Bioconductor, see</span></span>
<span><span class="co">##      'citation("Biobase")', and for packages 'citation("pkgname")'.</span></span>
<span><span class="co">##  </span></span>
<span><span class="co">##  Attaching package: 'Biobase'</span></span>
<span><span class="co">##  The following object is masked from 'package:MatrixGenerics':</span></span>
<span><span class="co">##  </span></span>
<span><span class="co">##      rowMedians</span></span>
<span><span class="co">##  The following objects are masked from 'package:matrixStats':</span></span>
<span><span class="co">##  </span></span>
<span><span class="co">##      anyMissing, rowMedians</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="https://github.com/js2264/HiCExperiment">HiCExperiment</a></span><span class="op">)</span></span>
<span><span class="co">##  Consider using the `HiContacts` package to perform advanced genomic operations </span></span>
<span><span class="co">##  on `HiCExperiment` objects.</span></span>
<span><span class="co">##  </span></span>
<span><span class="co">##  Read "Orchestrating Hi-C analysis with Bioconductor" online book to learn more:</span></span>
<span><span class="co">##  https://js2264.github.io/OHCA/</span></span>
<span><span class="co">##  </span></span>
<span><span class="co">##  Attaching package: 'HiCExperiment'</span></span>
<span><span class="co">##  The following object is masked from 'package:SummarizedExperiment':</span></span>
<span><span class="co">##  </span></span>
<span><span class="co">##      metadata&lt;-</span></span>
<span><span class="co">##  The following object is masked from 'package:S4Vectors':</span></span>
<span><span class="co">##  </span></span>
<span><span class="co">##      metadata&lt;-</span></span>
<span><span class="co">##  The following object is masked from 'package:ggplot2':</span></span>
<span><span class="co">##  </span></span>
<span><span class="co">##      resolution</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="https://github.com/js2264/HiContactsData">HiContactsData</a></span><span class="op">)</span></span>
<span><span class="co">##  Loading required package: ExperimentHub</span></span>
<span><span class="co">##  Loading required package: AnnotationHub</span></span>
<span><span class="co">##  Loading required package: BiocFileCache</span></span>
<span><span class="co">##  Loading required package: dbplyr</span></span>
<span><span class="co">##  </span></span>
<span><span class="co">##  Attaching package: 'dbplyr'</span></span>
<span><span class="co">##  The following objects are masked from 'package:dplyr':</span></span>
<span><span class="co">##  </span></span>
<span><span class="co">##      ident, sql</span></span>
<span><span class="co">##  </span></span>
<span><span class="co">##  Attaching package: 'AnnotationHub'</span></span>
<span><span class="co">##  The following object is masked from 'package:Biobase':</span></span>
<span><span class="co">##  </span></span>
<span><span class="co">##      cache</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="https://github.com/js2264/fourDNData">fourDNData</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="https://github.com/js2264/HiContacts">HiContacts</a></span><span class="op">)</span></span>
<span><span class="co">##  Registered S3 methods overwritten by 'readr':</span></span>
<span><span class="co">##    method                    from </span></span>
<span><span class="co">##    as.data.frame.spec_tbl_df vroom</span></span>
<span><span class="co">##    as_tibble.spec_tbl_df     vroom</span></span>
<span><span class="co">##    format.col_spec           vroom</span></span>
<span><span class="co">##    print.col_spec            vroom</span></span>
<span><span class="co">##    print.collector           vroom</span></span>
<span><span class="co">##    print.date_names          vroom</span></span>
<span><span class="co">##    print.locale              vroom</span></span>
<span><span class="co">##    str.col_spec              vroom</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va">rtracklayer</span><span class="op">)</span></span>
<span><span class="co">##  </span></span>
<span><span class="co">##  Attaching package: 'rtracklayer'</span></span>
<span><span class="co">##  The following object is masked from 'package:AnnotationHub':</span></span>
<span><span class="co">##  </span></span>
<span><span class="co">##      hubUrl</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="https://github.com/js2264/OHCA">OHCA</a></span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</div>
</div>
</div>
<div class="callout callout-style-default callout-note callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Aims
</div>
</div>
<div class="callout-body-container callout-body">
<p>This chapter focuses on the annotation of topological features from Hi-C contact maps, including:</p>
<ul>
<li>Chromosome compartments</li>
<li>Topologically associating domains</li>
<li>Stable chromatin loops</li>
</ul>
</div>
</div>
<section id="chromosome-compartments" class="level2" data-number="7.1"><h2 data-number="7.1" class="anchored" data-anchor-id="chromosome-compartments">
<span class="header-section-number">7.1</span> Chromosome compartments</h2>
<p>Chromosome compartments refer to the segregation of the chromatin into active euchromatin (A compartments) and regulated heterochromatin (B compartment).</p>
<section id="importing-hi-c-data" class="level3" data-number="7.1.1"><h3 data-number="7.1.1" class="anchored" data-anchor-id="importing-hi-c-data">
<span class="header-section-number">7.1.1</span> Importing Hi-C data</h3>
<p>To investigate chromosome compartments, we will fetch a contact matrix generated from a micro-C experiment (from <span class="citation" data-cites="Krietenstein_2020">Krietenstein et al. (<a href="#ref-Krietenstein_2020" role="doc-biblioref">2020</a>)</span>). A subset of the genome-wide dataset is provided in the <code>HiContactsData</code> package. It contains intra-chromosomal interactions within <code>chr17</code>, binned at <code>5000</code>, <code>100000</code> and <code>250000</code> bp.</p>
<div class="cell" data-layout-align="center">
<div class="sourceCode" id="cb2"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="https://github.com/js2264/HiCExperiment">HiCExperiment</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="https://github.com/js2264/HiContactsData">HiContactsData</a></span><span class="op">)</span></span>
<span><span class="va">cf</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/HiCExperiment/man/CoolFile-class.html">CoolFile</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/pkg/HiContactsData/man/HiContactsData.html">HiContactsData</a></span><span class="op">(</span><span class="st">'microC'</span>, <span class="st">'mcool'</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="co">##  see ?HiContactsData and browseVignettes('HiContactsData') for documentation</span></span>
<span><span class="co">##  downloading 1 resources</span></span>
<span><span class="co">##  retrieving 1 resource</span></span>
<span><span class="co">##  loading from cache</span></span>
<span><span class="va">microC</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/BiocIO/man/IO.html">import</a></span><span class="op">(</span><span class="va">cf</span>, resolution <span class="op">=</span> <span class="fl">250000</span><span class="op">)</span></span>
<span><span class="va">microC</span></span>
<span><span class="co">##  `HiCExperiment` object with 10,086,710 contacts over 334 regions </span></span>
<span><span class="co">##  -------</span></span>
<span><span class="co">##  fileName: "/root/.cache/R/ExperimentHub/147f7f61e92b_8601" </span></span>
<span><span class="co">##  focus: "whole genome" </span></span>
<span><span class="co">##  resolutions(3): 5000 100000 250000</span></span>
<span><span class="co">##  active resolution: 250000 </span></span>
<span><span class="co">##  interactions: 52755 </span></span>
<span><span class="co">##  scores(2): count balanced </span></span>
<span><span class="co">##  topologicalFeatures: compartments(0) borders(0) loops(0) viewpoints(0) </span></span>
<span><span class="co">##  pairsFile: N/A </span></span>
<span><span class="co">##  metadata(0):</span></span>
<span></span>
<span><span class="fu"><a href="https://rdrr.io/pkg/GenomeInfoDb/man/seqinfo.html">seqinfo</a></span><span class="op">(</span><span class="va">microC</span><span class="op">)</span></span>
<span><span class="co">##  Seqinfo object with 1 sequence from an unspecified genome:</span></span>
<span><span class="co">##    seqnames seqlengths isCircular genome</span></span>
<span><span class="co">##    chr17      83257441         NA   &lt;NA&gt;</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section><section id="annotating-ab-compartments" class="level3" data-number="7.1.2"><h3 data-number="7.1.2" class="anchored" data-anchor-id="annotating-ab-compartments">
<span class="header-section-number">7.1.2</span> Annotating A/B compartments</h3>
<p>The consensus approach to annotate A/B compartments is to compute the eigenvectors of a Hi-C contact matrix and identify the eigenvector representing the chromosome-wide bi-partite segmentation of the genome.</p>
<p>The <code><a href="https://rdrr.io/pkg/HiContacts/man/getCompartments.html">getCompartments()</a></code> function performs several internal operations to achieve this:</p>
<ol type="1">
<li>Obtains cis interactions per chromosome</li>
<li>Computes O/E contact matrix scores</li>
<li>Computes 3 first eigenvectors of this Hi-C contact matrix</li>
<li>Normalizes eigenvectors</li>
<li>Picks the eigenvector that has the greatest absolute correlation with a phasing track (e.g.&nbsp;a GC% track automatically computed from a genome reference sequence, or a gene density track)</li>
<li>Signs this eigenvector so that positive values represent the A compartment</li>
</ol>
<div class="cell" data-layout-align="center">
<div class="sourceCode" id="cb3"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">phasing_track</span> <span class="op">&lt;-</span> <span class="fu">BSgenome.Hsapiens.UCSC.hg38</span><span class="fu">::</span><span class="va"><a href="https://rdrr.io/pkg/BSgenome.Hsapiens.UCSC.hg38/man/package.html">BSgenome.Hsapiens.UCSC.hg38</a></span></span>
<span><span class="va">microC_compts</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/HiContacts/man/getCompartments.html">getCompartments</a></span><span class="op">(</span><span class="va">microC</span>, genome <span class="op">=</span> <span class="va">phasing_track</span><span class="op">)</span></span>
<span><span class="co">##  Going through preflight checklist...</span></span>
<span><span class="co">##  Parsing intra-chromosomal contacts for each chromosome...</span></span>
<span><span class="co">##  Computing eigenvectors for each chromosome...</span></span>
<span></span>
<span><span class="va">microC_compts</span></span>
<span><span class="co">##  `HiCExperiment` object with 10,086,710 contacts over 334 regions </span></span>
<span><span class="co">##  -------</span></span>
<span><span class="co">##  fileName: "/root/.cache/R/ExperimentHub/147f7f61e92b_8601" </span></span>
<span><span class="co">##  focus: "whole genome" </span></span>
<span><span class="co">##  resolutions(3): 5000 100000 250000</span></span>
<span><span class="co">##  active resolution: 250000 </span></span>
<span><span class="co">##  interactions: 52755 </span></span>
<span><span class="co">##  scores(2): count balanced </span></span>
<span><span class="co">##  topologicalFeatures: compartments(41) borders(0) loops(0) viewpoints(0) </span></span>
<span><span class="co">##  pairsFile: N/A </span></span>
<span><span class="co">##  metadata(1): eigens</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p><code><a href="https://rdrr.io/pkg/HiContacts/man/getCompartments.html">getCompartments()</a></code> is an endomorphism: it returns the original object, enriched with two new pieces of information:</p>
<ul>
<li>A <code>compartments</code> <code>topologicalFeatures</code>:</li>
</ul>
<div class="cell" data-layout-align="center">
<div class="sourceCode" id="cb4"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/pkg/HiCExperiment/man/AllGenerics.html">topologicalFeatures</a></span><span class="op">(</span><span class="va">microC_compts</span>, <span class="st">"compartments"</span><span class="op">)</span></span>
<span><span class="co">##  GRanges object with 41 ranges and 1 metadata column:</span></span>
<span><span class="co">##         seqnames            ranges strand | compartment</span></span>
<span><span class="co">##            &lt;Rle&gt;         &lt;IRanges&gt;  &lt;Rle&gt; | &lt;character&gt;</span></span>
<span><span class="co">##     [1]    chr17    250001-3000000      * |           A</span></span>
<span><span class="co">##     [2]    chr17   3000001-3500000      * |           B</span></span>
<span><span class="co">##     [3]    chr17   3500001-5500000      * |           A</span></span>
<span><span class="co">##     [4]    chr17   5500001-6500000      * |           B</span></span>
<span><span class="co">##     [5]    chr17   6500001-8500000      * |           A</span></span>
<span><span class="co">##     ...      ...               ...    ... .         ...</span></span>
<span><span class="co">##    [37]    chr17 72750001-73250000      * |           A</span></span>
<span><span class="co">##    [38]    chr17 73250001-74750000      * |           B</span></span>
<span><span class="co">##    [39]    chr17 74750001-79250000      * |           A</span></span>
<span><span class="co">##    [40]    chr17 79250001-79750000      * |           B</span></span>
<span><span class="co">##    [41]    chr17 79750001-83250000      * |           A</span></span>
<span><span class="co">##    -------</span></span>
<span><span class="co">##    seqinfo: 1 sequence from an unspecified genome</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<ul>
<li>The calculated eigenvectors stored in <code>metadata</code>:</li>
</ul>
<div class="cell" data-layout-align="center">
<div class="sourceCode" id="cb5"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/pkg/S4Vectors/man/Annotated-class.html">metadata</a></span><span class="op">(</span><span class="va">microC_compts</span><span class="op">)</span><span class="op">$</span><span class="va">eigens</span></span>
<span><span class="co">##  GRanges object with 334 ranges and 9 metadata columns:</span></span>
<span><span class="co">##                                  seqnames            ranges strand |</span></span>
<span><span class="co">##                                     &lt;Rle&gt;         &lt;IRanges&gt;  &lt;Rle&gt; |</span></span>
<span><span class="co">##             chr17.chr17_1_250000    chr17          1-250000      * |</span></span>
<span><span class="co">##        chr17.chr17_250001_500000    chr17     250001-500000      * |</span></span>
<span><span class="co">##        chr17.chr17_500001_750000    chr17     500001-750000      * |</span></span>
<span><span class="co">##       chr17.chr17_750001_1000000    chr17    750001-1000000      * |</span></span>
<span><span class="co">##      chr17.chr17_1000001_1250000    chr17   1000001-1250000      * |</span></span>
<span><span class="co">##                              ...      ...               ...    ... .</span></span>
<span><span class="co">##    chr17.chr17_82250001_82500000    chr17 82250001-82500000      * |</span></span>
<span><span class="co">##    chr17.chr17_82500001_82750000    chr17 82500001-82750000      * |</span></span>
<span><span class="co">##    chr17.chr17_82750001_83000000    chr17 82750001-83000000      * |</span></span>
<span><span class="co">##    chr17.chr17_83000001_83250000    chr17 83000001-83250000      * |</span></span>
<span><span class="co">##    chr17.chr17_83250001_83257441    chr17 83250001-83257441      * |</span></span>
<span><span class="co">##                                     bin_id     weight   chr    center</span></span>
<span><span class="co">##                                  &lt;numeric&gt;  &lt;numeric&gt; &lt;Rle&gt; &lt;integer&gt;</span></span>
<span><span class="co">##             chr17.chr17_1_250000         0        NaN chr17    125000</span></span>
<span><span class="co">##        chr17.chr17_250001_500000         1 0.00626903 chr17    375000</span></span>
<span><span class="co">##        chr17.chr17_500001_750000         2 0.00567190 chr17    625000</span></span>
<span><span class="co">##       chr17.chr17_750001_1000000         3 0.00528588 chr17    875000</span></span>
<span><span class="co">##      chr17.chr17_1000001_1250000         4 0.00464628 chr17   1125000</span></span>
<span><span class="co">##                              ...       ...        ...   ...       ...</span></span>
<span><span class="co">##    chr17.chr17_82250001_82500000       329 0.00463044 chr17  82375000</span></span>
<span><span class="co">##    chr17.chr17_82500001_82750000       330 0.00486910 chr17  82625000</span></span>
<span><span class="co">##    chr17.chr17_82750001_83000000       331 0.00561269 chr17  82875000</span></span>
<span><span class="co">##    chr17.chr17_83000001_83250000       332 0.00546433 chr17  83125000</span></span>
<span><span class="co">##    chr17.chr17_83250001_83257441       333        NaN chr17  83253721</span></span>
<span><span class="co">##                                         E1        E2        E3   phasing</span></span>
<span><span class="co">##                                  &lt;numeric&gt; &lt;numeric&gt; &lt;numeric&gt; &lt;numeric&gt;</span></span>
<span><span class="co">##             chr17.chr17_1_250000  0.000000  0.000000  0.000000  0.383084</span></span>
<span><span class="co">##        chr17.chr17_250001_500000  0.450991  0.653287  0.615300  0.433972</span></span>
<span><span class="co">##        chr17.chr17_500001_750000  0.716784  0.707461  0.845033  0.465556</span></span>
<span><span class="co">##       chr17.chr17_750001_1000000  0.904423  0.414952  0.864288  0.503592</span></span>
<span><span class="co">##      chr17.chr17_1000001_1250000  0.913023  0.266287  0.759016  0.547712</span></span>
<span><span class="co">##                              ...       ...       ...       ...       ...</span></span>
<span><span class="co">##    chr17.chr17_82250001_82500000  1.147060  0.239112  1.133498  0.550872</span></span>
<span><span class="co">##    chr17.chr17_82500001_82750000  1.106937  0.419647  1.169464  0.513212</span></span>
<span><span class="co">##    chr17.chr17_82750001_83000000  0.818990  0.591955  0.850340  0.522432</span></span>
<span><span class="co">##    chr17.chr17_83000001_83250000  0.874038  0.503175  0.847926  0.528448</span></span>
<span><span class="co">##    chr17.chr17_83250001_83257441  0.000000  0.000000  0.000000  0.000000</span></span>
<span><span class="co">##                                      eigen</span></span>
<span><span class="co">##                                  &lt;numeric&gt;</span></span>
<span><span class="co">##             chr17.chr17_1_250000  0.000000</span></span>
<span><span class="co">##        chr17.chr17_250001_500000  0.450991</span></span>
<span><span class="co">##        chr17.chr17_500001_750000  0.716784</span></span>
<span><span class="co">##       chr17.chr17_750001_1000000  0.904423</span></span>
<span><span class="co">##      chr17.chr17_1000001_1250000  0.913023</span></span>
<span><span class="co">##                              ...       ...</span></span>
<span><span class="co">##    chr17.chr17_82250001_82500000  1.147060</span></span>
<span><span class="co">##    chr17.chr17_82500001_82750000  1.106937</span></span>
<span><span class="co">##    chr17.chr17_82750001_83000000  0.818990</span></span>
<span><span class="co">##    chr17.chr17_83000001_83250000  0.874038</span></span>
<span><span class="co">##    chr17.chr17_83250001_83257441  0.000000</span></span>
<span><span class="co">##    -------</span></span>
<span><span class="co">##    seqinfo: 1 sequence from an unspecified genome</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section><section id="exporting-compartment-tracks" class="level3" data-number="7.1.3"><h3 data-number="7.1.3" class="anchored" data-anchor-id="exporting-compartment-tracks">
<span class="header-section-number">7.1.3</span> Exporting compartment tracks</h3>
<p>To save the eigenvector (as a <code>bigwig</code> file) and the compartments(as a <code>gff</code> file), the <code>export</code> function can be used:</p>
<div class="cell" data-layout-align="center">
<div class="sourceCode" id="cb6"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="https://bioconductor.org/packages/GenomicRanges">GenomicRanges</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va">rtracklayer</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/pkg/IRanges/man/coverage-methods.html">coverage</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/pkg/S4Vectors/man/Annotated-class.html">metadata</a></span><span class="op">(</span><span class="va">microC_compts</span><span class="op">)</span><span class="op">$</span><span class="va">eigens</span>, weight <span class="op">=</span> <span class="st">'eigen'</span><span class="op">)</span> <span class="op">|&gt;</span> <span class="fu"><a href="https://rdrr.io/pkg/BiocIO/man/IO.html">export</a></span><span class="op">(</span><span class="st">'microC_eigen.bw'</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/pkg/HiCExperiment/man/AllGenerics.html">topologicalFeatures</a></span><span class="op">(</span><span class="va">microC_compts</span>, <span class="st">"compartments"</span><span class="op">)</span> <span class="op">|&gt;</span> <span class="fu"><a href="https://rdrr.io/pkg/BiocIO/man/IO.html">export</a></span><span class="op">(</span><span class="st">'microC_compartments.gff3'</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section><section id="visualizing-compartment-tracks" class="level3" data-number="7.1.4"><h3 data-number="7.1.4" class="anchored" data-anchor-id="visualizing-compartment-tracks">
<span class="header-section-number">7.1.4</span> Visualizing compartment tracks</h3>
<p>Compartment tracks should be visualized in a dedicated genome browser, with the phasing track loaded as well, to ensure they are phased accordingly.<br>
That being said, it is possible to visualize a genome track in R besides the matching Hi-C contact matrix.</p>
<div class="cell" data-layout-align="center" data-fig.asp="1">
<div class="sourceCode" id="cb7"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="https://ggplot2.tidyverse.org">ggplot2</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="https://patchwork.data-imaginist.com">patchwork</a></span><span class="op">)</span></span>
<span><span class="va">microC</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/HiContacts/man/arithmetics.html">autocorrelate</a></span><span class="op">(</span><span class="va">microC</span><span class="op">)</span></span>
<span><span class="co">##  </span></span>
<span><span class="va">p1</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/HiContacts/man/plotMatrix.html">plotMatrix</a></span><span class="op">(</span><span class="va">microC</span>, use.scores <span class="op">=</span> <span class="st">'autocorrelated'</span>, scale <span class="op">=</span> <span class="st">'linear'</span>, limits <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="op">-</span><span class="fl">1</span>, <span class="fl">1</span><span class="op">)</span>, caption <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span></span>
<span><span class="va">eigen</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/IRanges/man/coverage-methods.html">coverage</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/pkg/S4Vectors/man/Annotated-class.html">metadata</a></span><span class="op">(</span><span class="va">microC_compts</span><span class="op">)</span><span class="op">$</span><span class="va">eigens</span>, weight <span class="op">=</span> <span class="st">'eigen'</span><span class="op">)</span><span class="op">[[</span><span class="fl">1</span><span class="op">]</span><span class="op">]</span></span>
<span><span class="va">eigen_df</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://tibble.tidyverse.org/reference/tibble.html">tibble</a></span><span class="op">(</span>pos <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/cumsum.html">cumsum</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/pkg/S4Vectors/man/Rle-class.html">runLength</a></span><span class="op">(</span><span class="va">eigen</span><span class="op">)</span><span class="op">)</span>, eigen <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/pkg/S4Vectors/man/Rle-class.html">runValue</a></span><span class="op">(</span><span class="va">eigen</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="va">p2</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html">ggplot</a></span><span class="op">(</span><span class="va">eigen_df</span>, <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">pos</span>, y <span class="op">=</span> <span class="va">eigen</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span> </span>
<span>    <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_ribbon.html">geom_area</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span> </span>
<span>    <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggtheme.html">theme_void</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span> </span>
<span>    <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/coord_cartesian.html">coord_cartesian</a></span><span class="op">(</span>expand <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span> <span class="op">+</span> </span>
<span>    <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html">labs</a></span><span class="op">(</span>x <span class="op">=</span> <span class="st">"Genomic position"</span>, y <span class="op">=</span> <span class="st">"Eigenvector value"</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://patchwork.data-imaginist.com/reference/wrap_plots.html">wrap_plots</a></span><span class="op">(</span><span class="va">p1</span>, <span class="va">p2</span>, ncol <span class="op">=</span> <span class="fl">1</span>, heights <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">10</span>, <span class="fl">1</span><span class="op">)</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure"><p><img src="topological-features_files/figure-html/unnamed-chunk-7-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<p>Here, we clearly note the concordance between the Hi-C correlation matrix, highlighting correlated interactions between pairs of genomic segments, and the eigenvector representing chromosome segmentation into 2 compartments: A (for positive values) and B (for negative values).</p>
</section><section id="saddle-plots" class="level3" data-number="7.1.5"><h3 data-number="7.1.5" class="anchored" data-anchor-id="saddle-plots">
<span class="header-section-number">7.1.5</span> Saddle plots</h3>
<p>Saddle plots are typically used to measure the <code>observed</code> vs.&nbsp;<code>expected</code> interaction scores within or between genomic loci belonging to A and B compartments.</p>
<p>Non-overlapping genomic windows are grouped in <code>nbins</code> quantiles (typically between 10 and 50 quantiles) according to their A/B compartment eigenvector value, from lowest eigenvector values (i.e.&nbsp;strongest B compartments) to highest eigenvector values (i.e.&nbsp;strongest A compartments). The average <code>observed</code> vs.&nbsp;<code>expected</code> interaction scores are then computed for pairwise eigenvector quantiles and plotted in a 2D heatmap.</p>
<div class="cell" data-layout-align="center">
<div class="sourceCode" id="cb8"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="https://github.com/Bioconductor/BiocParallel">BiocParallel</a></span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/pkg/HiContacts/man/plotSaddle.html">plotSaddle</a></span><span class="op">(</span><span class="va">microC_compts</span>, nbins <span class="op">=</span> <span class="fl">25</span>, BPPARAM <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/pkg/BiocParallel/man/SerialParam-class.html">SerialParam</a></span><span class="op">(</span>progressbar <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure"><p><img src="topological-features_files/figure-html/unnamed-chunk-8-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<p>Here, the top-left small corner represents average O/E scores between strong B compartments and the bottom-right larger corner represents average O/E scores between strong A compartments. Note that only <code>chr17</code> interactions are contained in this dataset, explaining the grainy aspect of the saddle plot.</p>
</section></section><section id="topological-domains" class="level2" data-number="7.2"><h2 data-number="7.2" class="anchored" data-anchor-id="topological-domains">
<span class="header-section-number">7.2</span> Topological domains</h2>
<p>Topological <em>domains</em> (a.k.a. Topologically Associating Domains, TADs, isolated neighborhoods, contact domains, …) refer to local chromosomal segments (e.b. roughly ≤ 1Mb in mammal genomes) which preferentially self-interact, in a constrained manner. They are demarcated by domain <em>boundaries</em>.</p>
<div class="quarto-figure quarto-figure-center">
<figure class="figure"><p><img src="images/20230403090000.png" class="img-fluid figure-img"></p>
</figure>
</div>
<p>They are generally conserved across cell types and species (<span class="citation" data-cites="Schmitt_2016">Schmitt et al. (<a href="#ref-Schmitt_2016" role="doc-biblioref">2016</a>)</span>), typically correlate with units of DNA replication (<span class="citation" data-cites="Pope_2014">Pope et al. (<a href="#ref-Pope_2014" role="doc-biblioref">2014</a>)</span>), and could play a role during development (<span class="citation" data-cites="Stadhouders_2019">Stadhouders et al. (<a href="#ref-Stadhouders_2019" role="doc-biblioref">2019</a>)</span>).</p>
<section id="computing-diamond-insulation-score" class="level3" data-number="7.2.1"><h3 data-number="7.2.1" class="anchored" data-anchor-id="computing-diamond-insulation-score">
<span class="header-section-number">7.2.1</span> Computing diamond insulation score</h3>
<p>Several approaches exist to annotate topological domains (<span class="citation" data-cites="Sefer_2022">Sefer (<a href="#ref-Sefer_2022" role="doc-biblioref">2022</a>)</span>). Several packages in R implement some of these functionalities, e.g.&nbsp;<code>spectralTAD</code> or <code>TADcompare</code>.</p>
<p><code>HiContacts</code> offers a simple <code>getDiamondInsulation</code> function which computes the diamond insulation score (<span class="citation" data-cites="Crane_2015">Crane et al. (<a href="#ref-Crane_2015" role="doc-biblioref">2015</a>)</span>). This score quantifies average interaction frequency in an insulation window (of a certain <code>window_size</code>) sliding along contact matrices at a chosen <code>resolution</code>.</p>
<div class="cell" data-layout-align="center">
<div class="sourceCode" id="cb9"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="co"># - Compute insulation score</span></span>
<span><span class="va">bpparam</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/BiocParallel/man/SerialParam-class.html">SerialParam</a></span><span class="op">(</span>progressbar <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span></span>
<span><span class="va">hic</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/HiCExperiment/man/AllGenerics.html">zoom</a></span><span class="op">(</span><span class="va">microC</span>, <span class="fl">5000</span><span class="op">)</span> <span class="op">|&gt;</span> </span>
<span>    <span class="fu"><a href="https://rdrr.io/pkg/HiCExperiment/man/AllGenerics.html">refocus</a></span><span class="op">(</span><span class="st">'chr17:60000001-83257441'</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>    <span class="fu"><a href="https://rdrr.io/pkg/HiContacts/man/getDiamondInsulation.html">getDiamondInsulation</a></span><span class="op">(</span>window_size <span class="op">=</span> <span class="fl">100000</span>, BPPARAM <span class="op">=</span> <span class="va">bpparam</span><span class="op">)</span> <span class="op">|&gt;</span> </span>
<span>    <span class="fu"><a href="https://rdrr.io/pkg/HiContacts/man/getDiamondInsulation.html">getBorders</a></span><span class="op">(</span><span class="op">)</span></span>
<span><span class="co">##  Going through preflight checklist...</span></span>
<span><span class="co">##  Scan each window and compute diamond insulation score...</span></span>
<span><span class="co">##  Annotating diamond score prominence for each window...</span></span>
<span></span>
<span><span class="va">hic</span></span>
<span><span class="co">##  `HiCExperiment` object with 2,156,222 contacts over 4,652 regions </span></span>
<span><span class="co">##  -------</span></span>
<span><span class="co">##  fileName: "/root/.cache/R/ExperimentHub/147f7f61e92b_8601" </span></span>
<span><span class="co">##  focus: "chr17:60,000,001-83,257,441" </span></span>
<span><span class="co">##  resolutions(3): 5000 100000 250000</span></span>
<span><span class="co">##  active resolution: 5000 </span></span>
<span><span class="co">##  interactions: 2156044 </span></span>
<span><span class="co">##  scores(2): count balanced </span></span>
<span><span class="co">##  topologicalFeatures: compartments(0) borders(21) loops(0) viewpoints(0) </span></span>
<span><span class="co">##  pairsFile: N/A </span></span>
<span><span class="co">##  metadata(1): insulation</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p><code><a href="https://rdrr.io/pkg/HiContacts/man/getDiamondInsulation.html">getDiamondInsulation()</a></code> is an endomorphism: it returns the original object, enriched with two new pieces of information:</p>
<ul>
<li>A <code>borders</code> <code>topologicalFeatures</code>:</li>
</ul>
<div class="cell" data-layout-align="center">
<div class="sourceCode" id="cb10"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/pkg/HiCExperiment/man/AllGenerics.html">topologicalFeatures</a></span><span class="op">(</span><span class="va">hic</span>, <span class="st">"borders"</span><span class="op">)</span></span>
<span><span class="co">##  GRanges object with 21 ranges and 1 metadata column:</span></span>
<span><span class="co">##           seqnames            ranges strand |     score</span></span>
<span><span class="co">##              &lt;Rle&gt;         &lt;IRanges&gt;  &lt;Rle&gt; | &lt;numeric&gt;</span></span>
<span><span class="co">##    strong    chr17 60105001-60110000      * |  0.574760</span></span>
<span><span class="co">##      weak    chr17 60210001-60215000      * |  0.414425</span></span>
<span><span class="co">##      weak    chr17 61415001-61420000      * |  0.346668</span></span>
<span><span class="co">##    strong    chr17 61500001-61505000      * |  0.544336</span></span>
<span><span class="co">##      weak    chr17 62930001-62935000      * |  0.399794</span></span>
<span><span class="co">##       ...      ...               ...    ... .       ...</span></span>
<span><span class="co">##      weak    chr17 78395001-78400000      * |  0.235613</span></span>
<span><span class="co">##      weak    chr17 79065001-79070000      * |  0.236535</span></span>
<span><span class="co">##      weak    chr17 80155001-80160000      * |  0.284855</span></span>
<span><span class="co">##      weak    chr17 81735001-81740000      * |  0.497478</span></span>
<span><span class="co">##    strong    chr17 81840001-81845000      * |  1.395949</span></span>
<span><span class="co">##    -------</span></span>
<span><span class="co">##    seqinfo: 1 sequence from an unspecified genome</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<ul>
<li>The calculated <code>insulation</code> scores stored in <code>metadata</code>:</li>
</ul>
<div class="cell" data-layout-align="center">
<div class="sourceCode" id="cb11"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/pkg/S4Vectors/man/Annotated-class.html">metadata</a></span><span class="op">(</span><span class="va">hic</span><span class="op">)</span><span class="op">$</span><span class="va">insulation</span></span>
<span><span class="co">##  GRanges object with 4611 ranges and 8 metadata columns:</span></span>
<span><span class="co">##                            seqnames            ranges strand |    bin_id</span></span>
<span><span class="co">##                               &lt;Rle&gt;         &lt;IRanges&gt;  &lt;Rle&gt; | &lt;numeric&gt;</span></span>
<span><span class="co">##    chr17_60100001_60105000    chr17 60100001-60105000      * |     12020</span></span>
<span><span class="co">##    chr17_60105001_60110000    chr17 60105001-60110000      * |     12021</span></span>
<span><span class="co">##    chr17_60110001_60115000    chr17 60110001-60115000      * |     12022</span></span>
<span><span class="co">##    chr17_60115001_60120000    chr17 60115001-60120000      * |     12023</span></span>
<span><span class="co">##    chr17_60120001_60125000    chr17 60120001-60125000      * |     12024</span></span>
<span><span class="co">##                        ...      ...               ...    ... .       ...</span></span>
<span><span class="co">##    chr17_83130001_83135000    chr17 83130001-83135000      * |     16626</span></span>
<span><span class="co">##    chr17_83135001_83140000    chr17 83135001-83140000      * |     16627</span></span>
<span><span class="co">##    chr17_83140001_83145000    chr17 83140001-83145000      * |     16628</span></span>
<span><span class="co">##    chr17_83145001_83150000    chr17 83145001-83150000      * |     16629</span></span>
<span><span class="co">##    chr17_83150001_83155000    chr17 83150001-83155000      * |     16630</span></span>
<span><span class="co">##                               weight   chr    center     score insulation</span></span>
<span><span class="co">##                            &lt;numeric&gt; &lt;Rle&gt; &lt;integer&gt; &lt;numeric&gt;  &lt;numeric&gt;</span></span>
<span><span class="co">##    chr17_60100001_60105000 0.0406489 chr17  60102500  0.188061  -0.750142</span></span>
<span><span class="co">##    chr17_60105001_60110000 0.0255539 chr17  60107500  0.180860  -0.806466</span></span>
<span><span class="co">##    chr17_60110001_60115000       NaN chr17  60112500  0.196579  -0.686232</span></span>
<span><span class="co">##    chr17_60115001_60120000       NaN chr17  60117500  0.216039  -0.550046</span></span>
<span><span class="co">##    chr17_60120001_60125000       NaN chr17  60122500  0.230035  -0.459489</span></span>
<span><span class="co">##                        ...       ...   ...       ...       ...        ...</span></span>
<span><span class="co">##    chr17_83130001_83135000 0.0314684 chr17  83132500  0.262191  -0.270723</span></span>
<span><span class="co">##    chr17_83135001_83140000 0.0307197 chr17  83137500  0.240779  -0.393632</span></span>
<span><span class="co">##    chr17_83140001_83145000 0.0322810 chr17  83142500  0.219113  -0.529664</span></span>
<span><span class="co">##    chr17_83145001_83150000 0.0280840 chr17  83147500  0.199645  -0.663900</span></span>
<span><span class="co">##    chr17_83150001_83155000 0.0272775 chr17  83152500  0.180434  -0.809873</span></span>
<span><span class="co">##                                  min prominence</span></span>
<span><span class="co">##                            &lt;logical&gt;  &lt;numeric&gt;</span></span>
<span><span class="co">##    chr17_60100001_60105000     FALSE         NA</span></span>
<span><span class="co">##    chr17_60105001_60110000      TRUE    0.57476</span></span>
<span><span class="co">##    chr17_60110001_60115000     FALSE         NA</span></span>
<span><span class="co">##    chr17_60115001_60120000     FALSE         NA</span></span>
<span><span class="co">##    chr17_60120001_60125000     FALSE         NA</span></span>
<span><span class="co">##                        ...       ...        ...</span></span>
<span><span class="co">##    chr17_83130001_83135000     FALSE         NA</span></span>
<span><span class="co">##    chr17_83135001_83140000     FALSE         NA</span></span>
<span><span class="co">##    chr17_83140001_83145000     FALSE         NA</span></span>
<span><span class="co">##    chr17_83145001_83150000     FALSE         NA</span></span>
<span><span class="co">##    chr17_83150001_83155000     FALSE         NA</span></span>
<span><span class="co">##    -------</span></span>
<span><span class="co">##    seqinfo: 1 sequence from an unspecified genome</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="callout callout-style-default callout-note callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Note
</div>
</div>
<div class="callout-body-container callout-body">
<p>The <code>getDiamondInsulation</code> function can be parallelized over multiple threads by specifying the Bioconductor generic <code>BPPARAM</code> argument.</p>
</div>
</div>
</section><section id="exporting-insulation-scores-tracks" class="level3" data-number="7.2.2"><h3 data-number="7.2.2" class="anchored" data-anchor-id="exporting-insulation-scores-tracks">
<span class="header-section-number">7.2.2</span> Exporting insulation scores tracks</h3>
<p>To save the diamond insulation scores (as a <code>bigwig</code> file) and the borders (as a <code>bed</code> file), the <code>export</code> function can be used:</p>
<div class="cell" data-layout-align="center">
<div class="sourceCode" id="cb12"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/pkg/IRanges/man/coverage-methods.html">coverage</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/pkg/S4Vectors/man/Annotated-class.html">metadata</a></span><span class="op">(</span><span class="va">hic</span><span class="op">)</span><span class="op">$</span><span class="va">insulation</span>, weight <span class="op">=</span> <span class="st">'insulation'</span><span class="op">)</span> <span class="op">|&gt;</span> <span class="fu"><a href="https://rdrr.io/pkg/BiocIO/man/IO.html">export</a></span><span class="op">(</span><span class="st">'microC_insulation.bw'</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/pkg/HiCExperiment/man/AllGenerics.html">topologicalFeatures</a></span><span class="op">(</span><span class="va">hic</span>, <span class="st">"borders"</span><span class="op">)</span> <span class="op">|&gt;</span> <span class="fu"><a href="https://rdrr.io/pkg/BiocIO/man/IO.html">export</a></span><span class="op">(</span><span class="st">'microC_borders.bed'</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section><section id="visualizing-chromatin-domains" class="level3" data-number="7.2.3"><h3 data-number="7.2.3" class="anchored" data-anchor-id="visualizing-chromatin-domains">
<span class="header-section-number">7.2.3</span> Visualizing chromatin domains</h3>
<p>Insulation tracks should be visualized in a dedicated genome browser.<br>
That being said, it is possible to visualize a genome track in R besides the matching Hi-C contact matrix.</p>
<div class="cell" data-layout-align="center" data-fig.asp="1">
<div class="sourceCode" id="cb13"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">hic</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/HiCExperiment/man/AllGenerics.html">zoom</a></span><span class="op">(</span><span class="va">hic</span>, <span class="fl">100000</span><span class="op">)</span></span>
<span><span class="va">p1</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/HiContacts/man/plotMatrix.html">plotMatrix</a></span><span class="op">(</span></span>
<span>    <span class="va">hic</span>, </span>
<span>    use.scores <span class="op">=</span> <span class="st">'balanced'</span>, </span>
<span>    limits <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="op">-</span><span class="fl">3.5</span>, <span class="op">-</span><span class="fl">1</span><span class="op">)</span>,</span>
<span>    borders <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/pkg/HiCExperiment/man/AllGenerics.html">topologicalFeatures</a></span><span class="op">(</span><span class="va">hic</span>, <span class="st">"borders"</span><span class="op">)</span>,</span>
<span>    caption <span class="op">=</span> <span class="cn">FALSE</span></span>
<span><span class="op">)</span></span>
<span><span class="va">insulation</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/IRanges/man/coverage-methods.html">coverage</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/pkg/S4Vectors/man/Annotated-class.html">metadata</a></span><span class="op">(</span><span class="va">hic</span><span class="op">)</span><span class="op">$</span><span class="va">insulation</span>, weight <span class="op">=</span> <span class="st">'insulation'</span><span class="op">)</span><span class="op">[[</span><span class="fl">1</span><span class="op">]</span><span class="op">]</span></span>
<span><span class="va">insulation_df</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://tibble.tidyverse.org/reference/tibble.html">tibble</a></span><span class="op">(</span>pos <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/cumsum.html">cumsum</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/pkg/S4Vectors/man/Rle-class.html">runLength</a></span><span class="op">(</span><span class="va">insulation</span><span class="op">)</span><span class="op">)</span>, insulation <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/pkg/S4Vectors/man/Rle-class.html">runValue</a></span><span class="op">(</span><span class="va">insulation</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="va">p2</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html">ggplot</a></span><span class="op">(</span><span class="va">insulation_df</span>, <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">pos</span>, y <span class="op">=</span> <span class="va">insulation</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span> </span>
<span>    <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_ribbon.html">geom_area</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span> </span>
<span>    <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggtheme.html">theme_void</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span> </span>
<span>    <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/coord_cartesian.html">coord_cartesian</a></span><span class="op">(</span>expand <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span> <span class="op">+</span> </span>
<span>    <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html">labs</a></span><span class="op">(</span>x <span class="op">=</span> <span class="st">"Genomic position"</span>, y <span class="op">=</span> <span class="st">"Diamond insulation score"</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://patchwork.data-imaginist.com/reference/wrap_plots.html">wrap_plots</a></span><span class="op">(</span><span class="va">p1</span>, <span class="va">p2</span>, ncol <span class="op">=</span> <span class="fl">1</span>, heights <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">10</span>, <span class="fl">1</span><span class="op">)</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure"><p><img src="topological-features_files/figure-html/unnamed-chunk-13-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<p>Local minima in the diamond insulation score displayed below the Hi-C contact matrix are identified using the <code><a href="https://rdrr.io/pkg/HiContacts/man/getDiamondInsulation.html">getBorders()</a></code> function, which automatically estimates a minimum threshold. These local minima correspond to borders and are visually depicted on the Hi-C map by blue diamonds.</p>
</section></section><section id="chromatin-loops" class="level2" data-number="7.3"><h2 data-number="7.3" class="anchored" data-anchor-id="chromatin-loops">
<span class="header-section-number">7.3</span> Chromatin loops</h2>
<section id="chromosight" class="level3" data-number="7.3.1"><h3 data-number="7.3.1" class="anchored" data-anchor-id="chromosight">
<span class="header-section-number">7.3.1</span> <code>chromosight</code>
</h3>
<p>Chromatin loops, dots, or contacts, refer to a strong increase of interaction frequency between a pair of two genomic loci. They correspond to focal “dots” on a Hi-C map. Relying on computer vision algorithms, <code>chromosight</code> uses this property to annotate chromatin loops in a Hi-C map (<span class="citation" data-cites="Matthey_Doret_2020">Matthey-Doret et al. (<a href="#ref-Matthey_Doret_2020" role="doc-biblioref">2020</a>)</span>). <code>chromosight</code> is a standalone <code>python</code> package and is made available in R through the <code>HiCool</code>-managed conda environment with the <code><a href="https://rdrr.io/pkg/HiContacts/man/getLoops.html">getLoops()</a></code> function.</p>
<div class="callout callout-style-default callout-important callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Important note:
</div>
</div>
<div class="callout-body-container callout-body">
<p><code>HiCool</code> relies on <code>basilisk</code> R package to set up an underlying, self-managed <code>python</code> environment. Packages from this environment, including <code>chromosight</code>, are not yet available for ARM chips (e.g.&nbsp;M1/2/3 in newer on macbooks) or Windows. For this reason, <code>HiCool</code>-supported features are not available on these machines.</p>
</div>
</div>
<section id="identifying-loops" class="level4" data-number="7.3.1.1"><h4 data-number="7.3.1.1" class="anchored" data-anchor-id="identifying-loops">
<span class="header-section-number">7.3.1.1</span> Identifying loops</h4>
<div class="cell" data-layout-align="center">
<div class="sourceCode" id="cb14"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="co">## Due to HiCool limitations when rendering the book, this code is not executed here</span></span>
<span><span class="va">hic</span> <span class="op">&lt;-</span> <span class="fu">HiCool</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/HiCool/man/getLoops.html">getLoops</a></span><span class="op">(</span><span class="va">microC</span>, resolution <span class="op">=</span> <span class="fl">5000</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell" data-layout-align="center">
<div class="sourceCode" id="cb15"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="co">## Instead we load pre-computed data from a backed-up object</span></span>
<span><span class="va">hic_rds</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/system.file.html">system.file</a></span><span class="op">(</span><span class="st">'extdata'</span>, <span class="st">'microC_with-loops.rds'</span>, package <span class="op">=</span> <span class="st">'OHCA'</span><span class="op">)</span></span>
<span><span class="va">hic</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/readRDS.html">readRDS</a></span><span class="op">(</span><span class="va">hic_rds</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell" data-layout-align="center">
<div class="sourceCode" id="cb16"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">hic</span></span>
<span><span class="co">##  `HiCExperiment` object with 2,103,634 contacts over 200 regions </span></span>
<span><span class="co">##  -------</span></span>
<span><span class="co">##  fileName: "../4d434d8538a0_4DNFI9FVHJZQ_subset.mcool" </span></span>
<span><span class="co">##  focus: "chr17:62,500,001-63,500,000" </span></span>
<span><span class="co">##  resolutions(1): 5000</span></span>
<span><span class="co">##  active resolution: 5000 </span></span>
<span><span class="co">##  interactions: 19667 </span></span>
<span><span class="co">##  scores(2): count balanced </span></span>
<span><span class="co">##  topologicalFeatures: loops(2419) </span></span>
<span><span class="co">##  pairsFile: N/A </span></span>
<span><span class="co">##  metadata(1): chromosight_args</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p><code><a href="https://rdrr.io/pkg/HiContacts/man/getLoops.html">getLoops()</a></code> is an endomorphism: it returns the original object, enriched with two new pieces of information:</p>
<ul>
<li>A <code>loops</code> <code>topologicalFeatures</code>:</li>
</ul>
<div class="cell" data-layout-align="center">
<div class="sourceCode" id="cb17"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/pkg/HiCExperiment/man/AllGenerics.html">topologicalFeatures</a></span><span class="op">(</span><span class="va">hic</span>, <span class="st">"loops"</span><span class="op">)</span></span>
<span><span class="co">##  GInteractions object with 2419 interactions and 7 metadata columns:</span></span>
<span><span class="co">##           seqnames1           ranges1     seqnames2           ranges2 |</span></span>
<span><span class="co">##               &lt;Rle&gt;         &lt;IRanges&gt;         &lt;Rle&gt;         &lt;IRanges&gt; |</span></span>
<span><span class="co">##       [1]     chr17     150000-155000 ---     chr17     390000-395000 |</span></span>
<span><span class="co">##       [2]     chr17     145000-150000 ---     chr17     755000-760000 |</span></span>
<span><span class="co">##       [3]     chr17     145000-150000 ---     chr17   1050000-1055000 |</span></span>
<span><span class="co">##       [4]     chr17     145000-150000 ---     chr17     510000-515000 |</span></span>
<span><span class="co">##       [5]     chr17     150000-155000 ---     chr17     990000-995000 |</span></span>
<span><span class="co">##       ...       ...               ... ...       ...               ... .</span></span>
<span><span class="co">##    [2415]     chr17 82870000-82875000 ---     chr17 83075000-83080000 |</span></span>
<span><span class="co">##    [2416]     chr17 82880000-82885000 ---     chr17 82925000-82930000 |</span></span>
<span><span class="co">##    [2417]     chr17 82960000-82965000 ---     chr17 83080000-83085000 |</span></span>
<span><span class="co">##    [2418]     chr17 82975000-82980000 ---     chr17 83000000-83005000 |</span></span>
<span><span class="co">##    [2419]     chr17 83100000-83105000 ---     chr17 83200000-83205000 |</span></span>
<span><span class="co">##                bin1      bin2 kernel_id iteration     score    pvalue</span></span>
<span><span class="co">##           &lt;numeric&gt; &lt;numeric&gt; &lt;numeric&gt; &lt;numeric&gt; &lt;numeric&gt; &lt;numeric&gt;</span></span>
<span><span class="co">##       [1]    498194    498242         0         0  0.666651         0</span></span>
<span><span class="co">##       [2]    498193    498315         0         0  0.452903         0</span></span>
<span><span class="co">##       [3]    498193    498374         0         0  0.518936         0</span></span>
<span><span class="co">##       [4]    498193    498266         0         0  0.536020         0</span></span>
<span><span class="co">##       [5]    498194    498362         0         0  0.573763         0</span></span>
<span><span class="co">##       ...       ...       ...       ...       ...       ...       ...</span></span>
<span><span class="co">##    [2415]    514738    514779         0         0  0.478653   0.0e+00</span></span>
<span><span class="co">##    [2416]    514740    514749         0         0  0.369344   5.0e-10</span></span>
<span><span class="co">##    [2417]    514756    514780         0         0  0.690669   0.0e+00</span></span>
<span><span class="co">##    [2418]    514759    514764         0         0  0.374722   5.1e-09</span></span>
<span><span class="co">##    [2419]    514784    514804         0         0  0.768593   0.0e+00</span></span>
<span><span class="co">##              qvalue</span></span>
<span><span class="co">##           &lt;numeric&gt;</span></span>
<span><span class="co">##       [1]         0</span></span>
<span><span class="co">##       [2]         0</span></span>
<span><span class="co">##       [3]         0</span></span>
<span><span class="co">##       [4]         0</span></span>
<span><span class="co">##       [5]         0</span></span>
<span><span class="co">##       ...       ...</span></span>
<span><span class="co">##    [2415]     0e+00</span></span>
<span><span class="co">##    [2416]     6e-10</span></span>
<span><span class="co">##    [2417]     0e+00</span></span>
<span><span class="co">##    [2418]     6e-09</span></span>
<span><span class="co">##    [2419]     0e+00</span></span>
<span><span class="co">##    -------</span></span>
<span><span class="co">##    regions: 3169 ranges and 0 metadata columns</span></span>
<span><span class="co">##    seqinfo: 1 sequence from an unspecified genome; no seqlengths</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<ul>
<li>The arguments used by <code>chromosight</code>, stored in <code>metadata</code>:</li>
</ul>
<div class="cell" data-layout-align="center">
<div class="sourceCode" id="cb18"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/pkg/S4Vectors/man/Annotated-class.html">metadata</a></span><span class="op">(</span><span class="va">hic</span><span class="op">)</span><span class="op">$</span><span class="va">chromosight_args</span></span>
<span><span class="co">##  $`--pattern`</span></span>
<span><span class="co">##  [1] "loops"</span></span>
<span><span class="co">##  </span></span>
<span><span class="co">##  $`--dump`</span></span>
<span><span class="co">##  [1] "/tmp/RtmpUN0slk"</span></span>
<span><span class="co">##  </span></span>
<span><span class="co">##  $`--inter`</span></span>
<span><span class="co">##  [1] FALSE</span></span>
<span><span class="co">##  </span></span>
<span><span class="co">##  $`--iterations`</span></span>
<span><span class="co">##  [1] "auto"</span></span>
<span><span class="co">##  </span></span>
<span><span class="co">##  $`--kernel-config`</span></span>
<span><span class="co">##  NULL</span></span>
<span><span class="co">##  </span></span>
<span><span class="co">##  $`--perc-zero`</span></span>
<span><span class="co">##  [1] "auto"</span></span>
<span><span class="co">##  </span></span>
<span><span class="co">##  $`--perc-undetected`</span></span>
<span><span class="co">##  [1] "auto"</span></span>
<span><span class="co">##  </span></span>
<span><span class="co">##  $`--tsvd`</span></span>
<span><span class="co">##  [1] FALSE</span></span>
<span><span class="co">##  </span></span>
<span><span class="co">##  $`--win-fmt`</span></span>
<span><span class="co">##  [1] "json"</span></span>
<span><span class="co">##  </span></span>
<span><span class="co">##  $`--win-size`</span></span>
<span><span class="co">##  [1] "auto"</span></span>
<span><span class="co">##  </span></span>
<span><span class="co">##  $`--no-plotting`</span></span>
<span><span class="co">##  [1] TRUE</span></span>
<span><span class="co">##  </span></span>
<span><span class="co">##  $`--smooth-trend`</span></span>
<span><span class="co">##  [1] FALSE</span></span>
<span><span class="co">##  </span></span>
<span><span class="co">##  $`--norm`</span></span>
<span><span class="co">##  [1] "auto"</span></span>
<span><span class="co">##  </span></span>
<span><span class="co">##  $`&lt;contact_map&gt;`</span></span>
<span><span class="co">##  [1] "/root/.cache/R/fourDNData/913914662_4DNFI9FVHJZQ.mcool::/resolutions/5000"</span></span>
<span><span class="co">##  </span></span>
<span><span class="co">##  $`--max-dist`</span></span>
<span><span class="co">##  [1] "auto"</span></span>
<span><span class="co">##  </span></span>
<span><span class="co">##  $`--min-dist`</span></span>
<span><span class="co">##  [1] "auto"</span></span>
<span><span class="co">##  </span></span>
<span><span class="co">##  $`--min-separation`</span></span>
<span><span class="co">##  [1] "auto"</span></span>
<span><span class="co">##  </span></span>
<span><span class="co">##  $`--n-mads`</span></span>
<span><span class="co">##  [1] 5</span></span>
<span><span class="co">##  </span></span>
<span><span class="co">##  $`&lt;prefix&gt;`</span></span>
<span><span class="co">##  [1] "chromosight/chromo"</span></span>
<span><span class="co">##  </span></span>
<span><span class="co">##  $`--pearson`</span></span>
<span><span class="co">##  [1] "auto"</span></span>
<span><span class="co">##  </span></span>
<span><span class="co">##  $`--subsample`</span></span>
<span><span class="co">##  [1] "no"</span></span>
<span><span class="co">##  </span></span>
<span><span class="co">##  $`--threads`</span></span>
<span><span class="co">##  [1] 1</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section><section id="importing-loops-from-files" class="level4" data-number="7.3.1.2"><h4 data-number="7.3.1.2" class="anchored" data-anchor-id="importing-loops-from-files">
<span class="header-section-number">7.3.1.2</span> Importing loops from files</h4>
<p>If you are using <code>chromosight</code> directly from the terminal (i.e.&nbsp;outside <code>R</code>), you can import the annotated loops in <code>R</code> as follows:</p>
<div class="cell" data-layout-align="center">
<div class="sourceCode" id="cb19"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="co">## Change the `.tsv` file to the local output file from chromosight</span></span>
<span><span class="va">loops</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/system.file.html">system.file</a></span><span class="op">(</span><span class="st">'extdata'</span>, <span class="st">'chromo.tsv'</span>, package <span class="op">=</span> <span class="st">'OHCA'</span><span class="op">)</span> <span class="op">|&gt;</span> </span>
<span>    <span class="fu">readr</span><span class="fu">::</span><span class="fu"><a href="https://readr.tidyverse.org/reference/read_delim.html">read_tsv</a></span><span class="op">(</span><span class="op">)</span> <span class="op">|&gt;</span> </span>
<span>    <span class="fu">plyinteractions</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/plyinteractions/man/ginteractions-construct.html">as_ginteractions</a></span><span class="op">(</span>seqnames1 <span class="op">=</span> <span class="va">chrom1</span>, seqnames2 <span class="op">=</span> <span class="va">chrom2</span><span class="op">)</span></span>
<span><span class="co">##  Rows: 2419 Columns: 13</span></span>
<span><span class="co">##  ── Column specification ─────────────────────────────────────────────────────</span></span>
<span><span class="co">##  Delimiter: "\t"</span></span>
<span><span class="co">##  chr  (2): chrom1, chrom2</span></span>
<span><span class="co">##  dbl (11): start1, end1, start2, end2, bin1, bin2, kernel_id, iteration, s...</span></span>
<span><span class="co">##  </span></span>
<span><span class="co">##  ℹ Use `spec()` to retrieve the full column specification for this data.</span></span>
<span><span class="co">##  ℹ Specify the column types or set `show_col_types = FALSE` to quiet this message.</span></span>
<span></span>
<span><span class="va">loops</span></span>
<span><span class="co">##  GInteractions object with 2419 interactions and 7 metadata columns:</span></span>
<span><span class="co">##           seqnames1           ranges1 strand1     seqnames2           ranges2</span></span>
<span><span class="co">##               &lt;Rle&gt;         &lt;IRanges&gt;   &lt;Rle&gt;         &lt;Rle&gt;         &lt;IRanges&gt;</span></span>
<span><span class="co">##       [1]     chr17     150000-155000       * ---     chr17     390000-395000</span></span>
<span><span class="co">##       [2]     chr17     145000-150000       * ---     chr17     755000-760000</span></span>
<span><span class="co">##       [3]     chr17     145000-150000       * ---     chr17   1050000-1055000</span></span>
<span><span class="co">##       [4]     chr17     145000-150000       * ---     chr17     510000-515000</span></span>
<span><span class="co">##       [5]     chr17     150000-155000       * ---     chr17     990000-995000</span></span>
<span><span class="co">##       ...       ...               ...     ... ...       ...               ...</span></span>
<span><span class="co">##    [2415]     chr17 82870000-82875000       * ---     chr17 83075000-83080000</span></span>
<span><span class="co">##    [2416]     chr17 82880000-82885000       * ---     chr17 82925000-82930000</span></span>
<span><span class="co">##    [2417]     chr17 82960000-82965000       * ---     chr17 83080000-83085000</span></span>
<span><span class="co">##    [2418]     chr17 82975000-82980000       * ---     chr17 83000000-83005000</span></span>
<span><span class="co">##    [2419]     chr17 83100000-83105000       * ---     chr17 83200000-83205000</span></span>
<span><span class="co">##           strand2 |      bin1      bin2 kernel_id iteration     score</span></span>
<span><span class="co">##             &lt;Rle&gt; | &lt;numeric&gt; &lt;numeric&gt; &lt;numeric&gt; &lt;numeric&gt; &lt;numeric&gt;</span></span>
<span><span class="co">##       [1]       * |    498194    498242         0         0  0.666651</span></span>
<span><span class="co">##       [2]       * |    498193    498315         0         0  0.452903</span></span>
<span><span class="co">##       [3]       * |    498193    498374         0         0  0.518936</span></span>
<span><span class="co">##       [4]       * |    498193    498266         0         0  0.536020</span></span>
<span><span class="co">##       [5]       * |    498194    498362         0         0  0.573763</span></span>
<span><span class="co">##       ...     ... .       ...       ...       ...       ...       ...</span></span>
<span><span class="co">##    [2415]       * |    514738    514779         0         0  0.478653</span></span>
<span><span class="co">##    [2416]       * |    514740    514749         0         0  0.369344</span></span>
<span><span class="co">##    [2417]       * |    514756    514780         0         0  0.690669</span></span>
<span><span class="co">##    [2418]       * |    514759    514764         0         0  0.374722</span></span>
<span><span class="co">##    [2419]       * |    514784    514804         0         0  0.768593</span></span>
<span><span class="co">##              pvalue    qvalue</span></span>
<span><span class="co">##           &lt;numeric&gt; &lt;numeric&gt;</span></span>
<span><span class="co">##       [1]         0         0</span></span>
<span><span class="co">##       [2]         0         0</span></span>
<span><span class="co">##       [3]         0         0</span></span>
<span><span class="co">##       [4]         0         0</span></span>
<span><span class="co">##       [5]         0         0</span></span>
<span><span class="co">##       ...       ...       ...</span></span>
<span><span class="co">##    [2415]   0.0e+00     0e+00</span></span>
<span><span class="co">##    [2416]   5.0e-10     6e-10</span></span>
<span><span class="co">##    [2417]   0.0e+00     0e+00</span></span>
<span><span class="co">##    [2418]   5.1e-09     6e-09</span></span>
<span><span class="co">##    [2419]   0.0e+00     0e+00</span></span>
<span><span class="co">##    -------</span></span>
<span><span class="co">##    regions: 3169 ranges and 0 metadata columns</span></span>
<span><span class="co">##    seqinfo: 1 sequence from an unspecified genome; no seqlengths</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section><section id="exporting-chromatin-loops" class="level4" data-number="7.3.1.3"><h4 data-number="7.3.1.3" class="anchored" data-anchor-id="exporting-chromatin-loops">
<span class="header-section-number">7.3.1.3</span> Exporting chromatin loops</h4>
<div class="cell" data-layout-align="center">
<div class="sourceCode" id="cb20"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">loops</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/HiCExperiment/man/AllGenerics.html">topologicalFeatures</a></span><span class="op">(</span><span class="va">hic</span>, <span class="st">"loops"</span><span class="op">)</span></span>
<span><span class="va">loops</span> <span class="op">&lt;-</span> <span class="va">loops</span><span class="op">[</span><span class="va">loops</span><span class="op">$</span><span class="va">score</span> <span class="op">&gt;=</span> <span class="fl">0.4</span> <span class="op">&amp;</span> <span class="va">loops</span><span class="op">$</span><span class="va">qvalue</span> <span class="op">&lt;=</span> <span class="fl">1e-6</span><span class="op">]</span></span>
<span><span class="fu">GenomicInteractions</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/GenomicInteractions/man/export.bedpe.html">export.bedpe</a></span><span class="op">(</span><span class="va">loops</span>, <span class="st">'loops.bedpe'</span><span class="op">)</span></span>
<span><span class="co">##  Warning in interactionCounts(x): 'counts' not in mcols of object; will</span></span>
<span><span class="co">##  return NULL</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section><section id="visualizing-chromatin-loops" class="level4" data-number="7.3.1.4"><h4 data-number="7.3.1.4" class="anchored" data-anchor-id="visualizing-chromatin-loops">
<span class="header-section-number">7.3.1.4</span> Visualizing chromatin loops</h4>
<div class="cell" data-layout-align="center">
<div class="sourceCode" id="cb21"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/pkg/HiContacts/man/plotMatrix.html">plotMatrix</a></span><span class="op">(</span></span>
<span>    <span class="va">hic</span>, </span>
<span>    loops <span class="op">=</span> <span class="va">loops</span>,</span>
<span>    limits <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="op">-</span><span class="fl">4</span>, <span class="op">-</span><span class="fl">1.2</span><span class="op">)</span>,</span>
<span>    caption <span class="op">=</span> <span class="cn">FALSE</span></span>
<span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure"><p><img src="topological-features_files/figure-html/unnamed-chunk-21-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
</section></section><section id="other-r-packages" class="level3" data-number="7.3.2"><h3 data-number="7.3.2" class="anchored" data-anchor-id="other-r-packages">
<span class="header-section-number">7.3.2</span> Other R packages</h3>
<p>A number of other R packages have been developed to identify focal chromatin loops, notably <code>fitHiC</code> (<span class="citation" data-cites="Ay_2014">Ay et al. (<a href="#ref-Ay_2014" role="doc-biblioref">2014</a>)</span>), <code>GOTHiC</code> (<span class="citation" data-cites="Mifsud_2017">Mifsud et al. (<a href="#ref-Mifsud_2017" role="doc-biblioref">2017</a>)</span>) or <code>idr2d</code> (<span class="citation" data-cites="Krismer_2020">Krismer et al. (<a href="#ref-Krismer_2020" role="doc-biblioref">2020</a>)</span>). Each fits a slightly different purpose, and we encourage the end user to read companion publications.</p>
</section></section><section id="session-info" class="level1 unnumbered"><h1 class="unnumbered">Session info</h1>
<div class="callout callout-style-default callout-note callout-titled">
<div class="callout-header d-flex align-content-center" data-bs-toggle="collapse" data-bs-target=".callout-5-contents" aria-controls="callout-5" aria-expanded="false" aria-label="Toggle callout">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Click to expand 👇
</div>
<div class="callout-btn-toggle d-inline-block border-0 py-1 ps-1 pe-0 float-end"><i class="callout-toggle"></i></div>
</div>
<div id="callout-5" class="callout-5-contents callout-collapse collapse">
<div class="callout-body-container callout-body">
<div class="cell" data-layout-align="center">
<div class="sourceCode" id="cb22"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="fu">sessioninfo</span><span class="fu">::</span><span class="fu"><a href="https://r-lib.github.io/sessioninfo/reference/session_info.html">session_info</a></span><span class="op">(</span>include_base <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span>
<span><span class="co">##  ─ Session info ────────────────────────────────────────────────────────────</span></span>
<span><span class="co">##   setting  value</span></span>
<span><span class="co">##   version  R Under development (unstable) (2024-01-17 r85813)</span></span>
<span><span class="co">##   os       Ubuntu 22.04.3 LTS</span></span>
<span><span class="co">##   system   x86_64, linux-gnu</span></span>
<span><span class="co">##   ui       X11</span></span>
<span><span class="co">##   language (EN)</span></span>
<span><span class="co">##   collate  C</span></span>
<span><span class="co">##   ctype    en_US.UTF-8</span></span>
<span><span class="co">##   tz       Etc/UTC</span></span>
<span><span class="co">##   date     2024-01-22</span></span>
<span><span class="co">##   pandoc   3.1.1 @ /usr/local/bin/ (via rmarkdown)</span></span>
<span><span class="co">##  </span></span>
<span><span class="co">##  ─ Packages ────────────────────────────────────────────────────────────────</span></span>
<span><span class="co">##   package                     * version     date (UTC) lib source</span></span>
<span><span class="co">##   abind                         1.4-5       2016-07-21 [2] CRAN (R 4.4.0)</span></span>
<span><span class="co">##   AnnotationDbi                 1.65.2      2023-11-03 [2] Bioconductor</span></span>
<span><span class="co">##   AnnotationFilter              1.27.0      2023-10-24 [2] Bioconductor</span></span>
<span><span class="co">##   AnnotationHub               * 3.11.1      2023-12-11 [2] Bioconductor 3.19 (R 4.4.0)</span></span>
<span><span class="co">##   backports                     1.4.1       2021-12-13 [2] CRAN (R 4.4.0)</span></span>
<span><span class="co">##   base                        * 4.4.0       2024-01-18 [3] local</span></span>
<span><span class="co">##   base64enc                     0.1-3       2015-07-28 [2] CRAN (R 4.4.0)</span></span>
<span><span class="co">##   beeswarm                      0.4.0       2021-06-01 [2] CRAN (R 4.4.0)</span></span>
<span><span class="co">##   Biobase                     * 2.63.0      2023-10-24 [2] Bioconductor</span></span>
<span><span class="co">##   BiocFileCache               * 2.11.1      2023-10-26 [2] Bioconductor</span></span>
<span><span class="co">##   BiocGenerics                * 0.49.1      2023-11-01 [2] Bioconductor</span></span>
<span><span class="co">##   BiocIO                        1.13.0      2023-10-24 [2] Bioconductor</span></span>
<span><span class="co">##   BiocManager                   1.30.22     2023-08-08 [2] CRAN (R 4.4.0)</span></span>
<span><span class="co">##   BiocParallel                * 1.37.0      2023-10-24 [2] Bioconductor</span></span>
<span><span class="co">##   BiocVersion                   3.19.1      2023-10-26 [2] Bioconductor</span></span>
<span><span class="co">##   biomaRt                       2.59.0      2023-10-25 [2] Bioconductor</span></span>
<span><span class="co">##   Biostrings                    2.71.1      2023-10-25 [2] Bioconductor</span></span>
<span><span class="co">##   biovizBase                    1.51.0      2023-10-25 [2] Bioconductor</span></span>
<span><span class="co">##   bit                           4.0.5       2022-11-15 [2] CRAN (R 4.4.0)</span></span>
<span><span class="co">##   bit64                         4.0.5       2020-08-30 [2] CRAN (R 4.4.0)</span></span>
<span><span class="co">##   bitops                        1.0-7       2021-04-24 [2] CRAN (R 4.4.0)</span></span>
<span><span class="co">##   blob                          1.2.4       2023-03-17 [2] CRAN (R 4.4.0)</span></span>
<span><span class="co">##   BSgenome                      1.71.1      2023-11-01 [2] Bioconductor</span></span>
<span><span class="co">##   BSgenome.Hsapiens.UCSC.hg38   1.4.5       2024-01-22 [2] Bioconductor</span></span>
<span><span class="co">##   cachem                        1.0.8       2023-05-01 [2] CRAN (R 4.4.0)</span></span>
<span><span class="co">##   Cairo                         1.6-2       2023-11-28 [2] CRAN (R 4.4.0)</span></span>
<span><span class="co">##   checkmate                     2.3.1       2023-12-04 [2] CRAN (R 4.4.0)</span></span>
<span><span class="co">##   cli                           3.6.2       2023-12-11 [2] CRAN (R 4.4.0)</span></span>
<span><span class="co">##   cluster                       2.1.6       2023-12-01 [3] CRAN (R 4.4.0)</span></span>
<span><span class="co">##   codetools                     0.2-19      2023-02-01 [3] CRAN (R 4.4.0)</span></span>
<span><span class="co">##   colorspace                    2.1-0       2023-01-23 [2] CRAN (R 4.4.0)</span></span>
<span><span class="co">##   compiler                      4.4.0       2024-01-18 [3] local</span></span>
<span><span class="co">##   crayon                        1.5.2       2022-09-29 [2] CRAN (R 4.4.0)</span></span>
<span><span class="co">##   curl                          5.2.0       2023-12-08 [2] CRAN (R 4.4.0)</span></span>
<span><span class="co">##   data.table                    1.14.10     2023-12-08 [2] CRAN (R 4.4.0)</span></span>
<span><span class="co">##   datasets                    * 4.4.0       2024-01-18 [3] local</span></span>
<span><span class="co">##   DBI                           1.2.1       2024-01-12 [2] CRAN (R 4.4.0)</span></span>
<span><span class="co">##   dbplyr                      * 2.4.0       2023-10-26 [2] CRAN (R 4.4.0)</span></span>
<span><span class="co">##   DelayedArray                  0.29.0      2023-10-24 [2] Bioconductor</span></span>
<span><span class="co">##   deldir                        2.0-2       2023-11-23 [2] CRAN (R 4.4.0)</span></span>
<span><span class="co">##   dichromat                     2.0-0.1     2022-05-02 [2] CRAN (R 4.4.0)</span></span>
<span><span class="co">##   digest                        0.6.34      2024-01-11 [2] CRAN (R 4.4.0)</span></span>
<span><span class="co">##   doParallel                    1.0.17      2022-02-07 [2] CRAN (R 4.4.0)</span></span>
<span><span class="co">##   dplyr                       * 1.1.4       2023-11-17 [2] CRAN (R 4.4.0)</span></span>
<span><span class="co">##   dynamicTreeCut                1.63-1      2016-03-11 [2] CRAN (R 4.4.0)</span></span>
<span><span class="co">##   ensembldb                     2.27.1      2023-11-20 [2] Bioconductor 3.19 (R 4.4.0)</span></span>
<span><span class="co">##   evaluate                      0.23        2023-11-01 [2] CRAN (R 4.4.0)</span></span>
<span><span class="co">##   ExperimentHub               * 2.11.1      2023-12-11 [2] Bioconductor 3.19 (R 4.4.0)</span></span>
<span><span class="co">##   fansi                         1.0.6       2023-12-08 [2] CRAN (R 4.4.0)</span></span>
<span><span class="co">##   farver                        2.1.1       2022-07-06 [2] CRAN (R 4.4.0)</span></span>
<span><span class="co">##   fastcluster                   1.2.6       2024-01-12 [2] CRAN (R 4.4.0)</span></span>
<span><span class="co">##   fastmap                       1.1.1       2023-02-24 [2] CRAN (R 4.4.0)</span></span>
<span><span class="co">##   filelock                      1.0.3       2023-12-11 [2] CRAN (R 4.4.0)</span></span>
<span><span class="co">##   foreach                       1.5.2       2022-02-02 [2] CRAN (R 4.4.0)</span></span>
<span><span class="co">##   foreign                       0.8-86      2023-11-28 [3] CRAN (R 4.4.0)</span></span>
<span><span class="co">##   Formula                       1.2-5       2023-02-24 [2] CRAN (R 4.4.0)</span></span>
<span><span class="co">##   fourDNData                  * 1.3.0       2023-10-31 [2] Bioconductor</span></span>
<span><span class="co">##   generics                      0.1.3       2022-07-05 [2] CRAN (R 4.4.0)</span></span>
<span><span class="co">##   GenomeInfoDb                * 1.39.5      2024-01-01 [2] Bioconductor 3.19 (R 4.4.0)</span></span>
<span><span class="co">##   GenomeInfoDbData              1.2.11      2024-01-22 [2] Bioconductor</span></span>
<span><span class="co">##   GenomicAlignments             1.39.2      2024-01-16 [2] Bioconductor 3.19 (R 4.4.0)</span></span>
<span><span class="co">##   GenomicFeatures               1.55.1      2023-10-29 [2] Bioconductor</span></span>
<span><span class="co">##   GenomicInteractions           1.37.0      2023-10-25 [2] Bioconductor</span></span>
<span><span class="co">##   GenomicRanges               * 1.55.1      2023-10-29 [2] Bioconductor</span></span>
<span><span class="co">##   ggbeeswarm                    0.7.2       2023-04-29 [2] CRAN (R 4.4.0)</span></span>
<span><span class="co">##   ggplot2                     * 3.4.4       2023-10-12 [2] CRAN (R 4.4.0)</span></span>
<span><span class="co">##   ggrastr                       1.0.2       2023-06-01 [2] CRAN (R 4.4.0)</span></span>
<span><span class="co">##   glue                          1.7.0       2024-01-09 [2] CRAN (R 4.4.0)</span></span>
<span><span class="co">##   GO.db                         3.18.0      2024-01-22 [2] Bioconductor</span></span>
<span><span class="co">##   graphics                    * 4.4.0       2024-01-18 [3] local</span></span>
<span><span class="co">##   grDevices                   * 4.4.0       2024-01-18 [3] local</span></span>
<span><span class="co">##   grid                          4.4.0       2024-01-18 [3] local</span></span>
<span><span class="co">##   gridExtra                     2.3         2017-09-09 [2] CRAN (R 4.4.0)</span></span>
<span><span class="co">##   gtable                        0.3.4       2023-08-21 [2] CRAN (R 4.4.0)</span></span>
<span><span class="co">##   Gviz                          1.47.1      2023-11-16 [2] Bioconductor 3.19 (R 4.4.0)</span></span>
<span><span class="co">##   HiCExperiment               * 1.3.0       2023-10-24 [2] Bioconductor</span></span>
<span><span class="co">##   HiContacts                  * 1.5.0       2023-10-24 [2] Bioconductor</span></span>
<span><span class="co">##   HiContactsData              * 1.5.3       2024-01-22 [2] Github (js2264/HiContactsData@d5bebe7)</span></span>
<span><span class="co">##   Hmisc                         5.1-1       2023-09-12 [2] CRAN (R 4.4.0)</span></span>
<span><span class="co">##   hms                           1.1.3       2023-03-21 [2] CRAN (R 4.4.0)</span></span>
<span><span class="co">##   htmlTable                     2.4.2       2023-10-29 [2] CRAN (R 4.4.0)</span></span>
<span><span class="co">##   htmltools                     0.5.7       2023-11-03 [2] CRAN (R 4.4.0)</span></span>
<span><span class="co">##   htmlwidgets                   1.6.4       2023-12-06 [2] CRAN (R 4.4.0)</span></span>
<span><span class="co">##   httr                          1.4.7       2023-08-15 [2] CRAN (R 4.4.0)</span></span>
<span><span class="co">##   igraph                        1.6.0       2023-12-11 [2] CRAN (R 4.4.0)</span></span>
<span><span class="co">##   impute                        1.77.0      2023-10-24 [2] Bioconductor</span></span>
<span><span class="co">##   InteractionSet              * 1.31.0      2023-10-24 [2] Bioconductor</span></span>
<span><span class="co">##   interp                        1.1-5       2023-11-27 [2] CRAN (R 4.4.0)</span></span>
<span><span class="co">##   IRanges                     * 2.37.1      2024-01-19 [2] Bioconductor 3.19 (R 4.4.0)</span></span>
<span><span class="co">##   iterators                     1.0.14      2022-02-05 [2] CRAN (R 4.4.0)</span></span>
<span><span class="co">##   jpeg                          0.1-10      2022-11-29 [2] CRAN (R 4.4.0)</span></span>
<span><span class="co">##   jsonlite                      1.8.8       2023-12-04 [2] CRAN (R 4.4.0)</span></span>
<span><span class="co">##   KEGGREST                      1.43.0      2023-10-24 [2] Bioconductor</span></span>
<span><span class="co">##   knitr                         1.45        2023-10-30 [2] CRAN (R 4.4.0)</span></span>
<span><span class="co">##   labeling                      0.4.3       2023-08-29 [2] CRAN (R 4.4.0)</span></span>
<span><span class="co">##   lattice                       0.22-5      2023-10-24 [3] CRAN (R 4.4.0)</span></span>
<span><span class="co">##   latticeExtra                  0.6-30      2022-07-04 [2] CRAN (R 4.4.0)</span></span>
<span><span class="co">##   lazyeval                      0.2.2       2019-03-15 [2] CRAN (R 4.4.0)</span></span>
<span><span class="co">##   lifecycle                     1.0.4       2023-11-07 [2] CRAN (R 4.4.0)</span></span>
<span><span class="co">##   magrittr                      2.0.3       2022-03-30 [2] CRAN (R 4.4.0)</span></span>
<span><span class="co">##   Matrix                        1.6-5       2024-01-11 [3] CRAN (R 4.4.0)</span></span>
<span><span class="co">##   MatrixGenerics              * 1.15.0      2023-10-24 [2] Bioconductor</span></span>
<span><span class="co">##   matrixStats                 * 1.2.0       2023-12-11 [2] CRAN (R 4.4.0)</span></span>
<span><span class="co">##   memoise                       2.0.1       2021-11-26 [2] CRAN (R 4.4.0)</span></span>
<span><span class="co">##   methods                     * 4.4.0       2024-01-18 [3] local</span></span>
<span><span class="co">##   mime                          0.12        2021-09-28 [2] CRAN (R 4.4.0)</span></span>
<span><span class="co">##   munsell                       0.5.0       2018-06-12 [2] CRAN (R 4.4.0)</span></span>
<span><span class="co">##   nnet                          7.3-19      2023-05-03 [3] CRAN (R 4.4.0)</span></span>
<span><span class="co">##   OHCA                        * 0.99.7      2024-01-22 [1] Bioconductor</span></span>
<span><span class="co">##   parallel                      4.4.0       2024-01-18 [3] local</span></span>
<span><span class="co">##   patchwork                   * 1.2.0       2024-01-08 [2] CRAN (R 4.4.0)</span></span>
<span><span class="co">##   pillar                        1.9.0       2023-03-22 [2] CRAN (R 4.4.0)</span></span>
<span><span class="co">##   pkgconfig                     2.0.3       2019-09-22 [2] CRAN (R 4.4.0)</span></span>
<span><span class="co">##   plyinteractions               1.1.0       2023-10-24 [2] Bioconductor</span></span>
<span><span class="co">##   plyranges                     1.23.0      2023-10-24 [2] Bioconductor</span></span>
<span><span class="co">##   png                           0.1-8       2022-11-29 [2] CRAN (R 4.4.0)</span></span>
<span><span class="co">##   preprocessCore                1.65.0      2023-10-24 [2] Bioconductor</span></span>
<span><span class="co">##   prettyunits                   1.2.0       2023-09-24 [2] CRAN (R 4.4.0)</span></span>
<span><span class="co">##   progress                      1.2.3       2023-12-06 [2] CRAN (R 4.4.0)</span></span>
<span><span class="co">##   ProtGenerics                  1.35.1      2024-01-17 [2] Bioconductor 3.19 (R 4.4.0)</span></span>
<span><span class="co">##   purrr                         1.0.2       2023-08-10 [2] CRAN (R 4.4.0)</span></span>
<span><span class="co">##   R6                            2.5.1       2021-08-19 [2] CRAN (R 4.4.0)</span></span>
<span><span class="co">##   rappdirs                      0.3.3       2021-01-31 [2] CRAN (R 4.4.0)</span></span>
<span><span class="co">##   RColorBrewer                  1.1-3       2022-04-03 [2] CRAN (R 4.4.0)</span></span>
<span><span class="co">##   Rcpp                          1.0.12      2024-01-09 [2] CRAN (R 4.4.0)</span></span>
<span><span class="co">##   RCurl                         1.98-1.14   2024-01-09 [2] CRAN (R 4.4.0)</span></span>
<span><span class="co">##   readr                         2.1.5       2024-01-10 [2] CRAN (R 4.4.0)</span></span>
<span><span class="co">##   restfulr                      0.0.15      2022-06-16 [2] CRAN (R 4.4.0)</span></span>
<span><span class="co">##   rhdf5                         2.47.2      2024-01-15 [2] Bioconductor 3.19 (R 4.4.0)</span></span>
<span><span class="co">##   rhdf5filters                  1.15.1      2023-11-06 [2] Bioconductor</span></span>
<span><span class="co">##   Rhdf5lib                      1.25.1      2023-12-11 [2] Bioconductor 3.19 (R 4.4.0)</span></span>
<span><span class="co">##   rjson                         0.2.21      2022-01-09 [2] CRAN (R 4.4.0)</span></span>
<span><span class="co">##   rlang                         1.1.3       2024-01-10 [2] CRAN (R 4.4.0)</span></span>
<span><span class="co">##   rmarkdown                     2.25        2023-09-18 [2] CRAN (R 4.4.0)</span></span>
<span><span class="co">##   rpart                         4.1.23      2023-12-05 [3] CRAN (R 4.4.0)</span></span>
<span><span class="co">##   Rsamtools                     2.19.3      2024-01-17 [2] Bioconductor 3.19 (R 4.4.0)</span></span>
<span><span class="co">##   RSpectra                      0.16-1      2022-04-24 [2] CRAN (R 4.4.0)</span></span>
<span><span class="co">##   RSQLite                       2.3.5       2024-01-21 [2] CRAN (R 4.4.0)</span></span>
<span><span class="co">##   rstudioapi                    0.15.0      2023-07-07 [2] CRAN (R 4.4.0)</span></span>
<span><span class="co">##   rtracklayer                 * 1.63.0      2024-01-22 [2] Github (lawremi/rtracklayer@86407bb)</span></span>
<span><span class="co">##   S4Arrays                      1.3.2       2024-01-14 [2] Bioconductor 3.19 (R 4.4.0)</span></span>
<span><span class="co">##   S4Vectors                   * 0.41.3      2024-01-01 [2] Bioconductor 3.19 (R 4.4.0)</span></span>
<span><span class="co">##   scales                        1.3.0       2023-11-28 [2] CRAN (R 4.4.0)</span></span>
<span><span class="co">##   sessioninfo                   1.2.2       2021-12-06 [2] CRAN (R 4.4.0)</span></span>
<span><span class="co">##   SparseArray                   1.3.3       2024-01-14 [2] Bioconductor 3.19 (R 4.4.0)</span></span>
<span><span class="co">##   splines                       4.4.0       2024-01-18 [3] local</span></span>
<span><span class="co">##   stats                       * 4.4.0       2024-01-18 [3] local</span></span>
<span><span class="co">##   stats4                      * 4.4.0       2024-01-18 [3] local</span></span>
<span><span class="co">##   strawr                        0.0.91      2023-03-29 [2] CRAN (R 4.4.0)</span></span>
<span><span class="co">##   stringi                       1.8.3       2023-12-11 [2] CRAN (R 4.4.0)</span></span>
<span><span class="co">##   stringr                       1.5.1       2023-11-14 [2] CRAN (R 4.4.0)</span></span>
<span><span class="co">##   SummarizedExperiment        * 1.33.2      2024-01-07 [2] Bioconductor 3.19 (R 4.4.0)</span></span>
<span><span class="co">##   survival                      3.5-7       2023-08-14 [3] CRAN (R 4.4.0)</span></span>
<span><span class="co">##   tibble                        3.2.1       2023-03-20 [2] CRAN (R 4.4.0)</span></span>
<span><span class="co">##   tidyr                         1.3.0       2023-01-24 [2] CRAN (R 4.4.0)</span></span>
<span><span class="co">##   tidyselect                    1.2.0       2022-10-10 [2] CRAN (R 4.4.0)</span></span>
<span><span class="co">##   tools                         4.4.0       2024-01-18 [3] local</span></span>
<span><span class="co">##   tzdb                          0.4.0       2023-05-12 [2] CRAN (R 4.4.0)</span></span>
<span><span class="co">##   utf8                          1.2.4       2023-10-22 [2] CRAN (R 4.4.0)</span></span>
<span><span class="co">##   utils                       * 4.4.0       2024-01-18 [3] local</span></span>
<span><span class="co">##   VariantAnnotation             1.49.5      2024-01-14 [2] Bioconductor 3.19 (R 4.4.0)</span></span>
<span><span class="co">##   vctrs                         0.6.5       2023-12-01 [2] CRAN (R 4.4.0)</span></span>
<span><span class="co">##   vipor                         0.4.7       2023-12-18 [2] CRAN (R 4.4.0)</span></span>
<span><span class="co">##   vroom                         1.6.5       2023-12-05 [2] CRAN (R 4.4.0)</span></span>
<span><span class="co">##   WGCNA                         1.72-5      2023-12-07 [2] CRAN (R 4.4.0)</span></span>
<span><span class="co">##   withr                         3.0.0       2024-01-16 [2] CRAN (R 4.4.0)</span></span>
<span><span class="co">##   xfun                          0.41        2023-11-01 [2] CRAN (R 4.4.0)</span></span>
<span><span class="co">##   XML                           3.99-0.16.1 2024-01-22 [2] CRAN (R 4.4.0)</span></span>
<span><span class="co">##   xml2                          1.3.6       2023-12-04 [2] CRAN (R 4.4.0)</span></span>
<span><span class="co">##   XVector                       0.43.1      2024-01-10 [2] Bioconductor 3.19 (R 4.4.0)</span></span>
<span><span class="co">##   yaml                          2.3.8       2023-12-11 [2] CRAN (R 4.4.0)</span></span>
<span><span class="co">##   zlibbioc                      1.49.0      2023-10-24 [2] Bioconductor</span></span>
<span><span class="co">##  </span></span>
<span><span class="co">##   [1] /tmp/Rtmp4kTMSb/Rinstb104d8a34</span></span>
<span><span class="co">##   [2] /usr/local/lib/R/site-library</span></span>
<span><span class="co">##   [3] /usr/local/lib/R/library</span></span>
<span><span class="co">##  </span></span>
<span><span class="co">##  ───────────────────────────────────────────────────────────────────────────</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</div>
</div>
</div>
</section><section id="references" class="level1 unnumbered"><h1 class="unnumbered">References</h1>


<div id="refs" class="references csl-bib-body hanging-indent" data-line-spacing="2" role="list">
<div id="ref-Ay_2014" class="csl-entry" role="listitem">
Ay, F., Bailey, T. L., &amp; Noble, W. S. (2014). Statistical confidence estimation for hi-c data reveals regulatory chromatin contacts. <em>Genome Research</em>, <em>24</em>(6), 999–1011. <a href="https://doi.org/10.1101/gr.160374.113">https://doi.org/10.1101/gr.160374.113</a>
</div>
<div id="ref-Crane_2015" class="csl-entry" role="listitem">
Crane, E., Bian, Q., McCord, R. P., Lajoie, B. R., Wheeler, B. S., Ralston, E. J., Uzawa, S., Dekker, J., &amp; Meyer, B. J. (2015). Condensin-driven remodelling of x chromosome topology during dosage compensation. <em>Nature</em>, <em>523</em>(7559), 240–244. <a href="https://doi.org/10.1038/nature14450">https://doi.org/10.1038/nature14450</a>
</div>
<div id="ref-Krietenstein_2020" class="csl-entry" role="listitem">
Krietenstein, N., Abraham, S., Venev, S. V., Abdennur, N., Gibcus, J., Hsieh, T.-H. S., Parsi, K. M., Yang, L., Maehr, R., Mirny, L. A., Dekker, J., &amp; Rando, O. J. (2020). Ultrastructural details of mammalian chromosome architecture. <em>Molecular Cell</em>, <em>78</em>(3), 554–565.e7. <a href="https://doi.org/10.1016/j.molcel.2020.03.003">https://doi.org/10.1016/j.molcel.2020.03.003</a>
</div>
<div id="ref-Krismer_2020" class="csl-entry" role="listitem">
Krismer, K., Guo, Y., &amp; Gifford, D. K. (2020). <span>IDR</span>2D identifies reproducible genomic interactions. <em>Nucleic Acids Research</em>, <em>48</em>(6), e31–e31. <a href="https://doi.org/10.1093/nar/gkaa030">https://doi.org/10.1093/nar/gkaa030</a>
</div>
<div id="ref-Matthey_Doret_2020" class="csl-entry" role="listitem">
Matthey-Doret, C., Baudry, L., Breuer, A., Montagne, R., Guiglielmoni, N., Scolari, V., Jean, E., Campeas, A., Chanut, P. H., Oriol, E., Méot, A., Politis, L., Vigouroux, A., Moreau, P., Koszul, R., &amp; Cournac, A. (2020). Computer vision for pattern detection in chromosome contact maps. <em>Nature Communications</em>, <em>11</em>(1). <a href="https://doi.org/10.1038/s41467-020-19562-7">https://doi.org/10.1038/s41467-020-19562-7</a>
</div>
<div id="ref-Mifsud_2017" class="csl-entry" role="listitem">
Mifsud, B., Martincorena, I., Darbo, E., Sugar, R., Schoenfelder, S., Fraser, P., &amp; Luscombe, N. M. (2017). <span>GOTHiC</span>, a probabilistic model to resolve complex biases and to identify real interactions in hi-c data. <em><span>PLOS</span> <span>ONE</span></em>, <em>12</em>(4), e0174744. <a href="https://doi.org/10.1371/journal.pone.0174744">https://doi.org/10.1371/journal.pone.0174744</a>
</div>
<div id="ref-Pope_2014" class="csl-entry" role="listitem">
Pope, B. D., Ryba, T., Dileep, V., Yue, F., Wu, W., Denas, O., Vera, D. L., Wang, Y., Hansen, R. S., Canfield, T. K., Thurman, R. E., Cheng, Y., Gülsoy, G., Dennis, J. H., Snyder, M. P., Stamatoyannopoulos, J. A., Taylor, J., Hardison, R. C., Kahveci, T., … Gilbert, D. M. (2014). Topologically associating domains are stable units of replication-timing regulation. <em>Nature</em>, <em>515</em>(7527), 402–405. <a href="https://doi.org/10.1038/nature13986">https://doi.org/10.1038/nature13986</a>
</div>
<div id="ref-Schmitt_2016" class="csl-entry" role="listitem">
Schmitt, A. D., Hu, M., Jung, I., Xu, Z., Qiu, Y., Tan, C. L., Li, Y., Lin, S., Lin, Y., Barr, C. L., &amp; Ren, B. (2016). A compendium of chromatin contact maps reveals spatially active regions in the human genome. <em>Cell Reports</em>, <em>17</em>(8), 2042–2059. <a href="https://doi.org/10.1016/j.celrep.2016.10.061">https://doi.org/10.1016/j.celrep.2016.10.061</a>
</div>
<div id="ref-Sefer_2022" class="csl-entry" role="listitem">
Sefer, E. (2022). A comparison of topologically associating domain callers over mammals at high resolution. <em><span>BMC</span> Bioinformatics</em>, <em>23</em>(1). <a href="https://doi.org/10.1186/s12859-022-04674-2">https://doi.org/10.1186/s12859-022-04674-2</a>
</div>
<div id="ref-Stadhouders_2019" class="csl-entry" role="listitem">
Stadhouders, R., Filion, G. J., &amp; Graf, T. (2019). Transcription factors and 3D genome conformation in cell-fate decisions. <em>Nature</em>, <em>569</em>(7756), 345–354. <a href="https://doi.org/10.1038/s41586-019-1182-7">https://doi.org/10.1038/s41586-019-1182-7</a>
</div>
</div>
</section><a onclick="window.scrollTo(0, 0); return false;" role="button" id="quarto-back-to-top"><i class="bi bi-arrow-up"></i> Back to top</a></main><!-- /main --><script id="quarto-html-after-body" type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const toggleBodyColorMode = (bsSheetEl) => {
    const mode = bsSheetEl.getAttribute("data-mode");
    const bodyEl = window.document.querySelector("body");
    if (mode === "dark") {
      bodyEl.classList.add("quarto-dark");
      bodyEl.classList.remove("quarto-light");
    } else {
      bodyEl.classList.add("quarto-light");
      bodyEl.classList.remove("quarto-dark");
    }
  }
  const toggleBodyColorPrimary = () => {
    const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
    if (bsSheetEl) {
      toggleBodyColorMode(bsSheetEl);
    }
  }
  toggleBodyColorPrimary();  
  const icon = "";
  const anchorJS = new window.AnchorJS();
  anchorJS.options = {
    placement: 'right',
    icon: icon
  };
  anchorJS.add('.anchored');
  const isCodeAnnotation = (el) => {
    for (const clz of el.classList) {
      if (clz.startsWith('code-annotation-')) {                     
        return true;
      }
    }
    return false;
  }
  const clipboard = new window.ClipboardJS('.code-copy-button', {
    text: function(trigger) {
      const codeEl = trigger.previousElementSibling.cloneNode(true);
      for (const childEl of codeEl.children) {
        if (isCodeAnnotation(childEl)) {
          childEl.remove();
        }
      }
      return codeEl.innerText;
    }
  });
  clipboard.on('success', function(e) {
    // button target
    const button = e.trigger;
    // don't keep focus
    button.blur();
    // flash "checked"
    button.classList.add('code-copy-button-checked');
    var currentTitle = button.getAttribute("title");
    button.setAttribute("title", "Copied!");
    let tooltip;
    if (window.bootstrap) {
      button.setAttribute("data-bs-toggle", "tooltip");
      button.setAttribute("data-bs-placement", "left");
      button.setAttribute("data-bs-title", "Copied!");
      tooltip = new bootstrap.Tooltip(button, 
        { trigger: "manual", 
          customClass: "code-copy-button-tooltip",
          offset: [0, -8]});
      tooltip.show();    
    }
    setTimeout(function() {
      if (tooltip) {
        tooltip.hide();
        button.removeAttribute("data-bs-title");
        button.removeAttribute("data-bs-toggle");
        button.removeAttribute("data-bs-placement");
      }
      button.setAttribute("title", currentTitle);
      button.classList.remove('code-copy-button-checked');
    }, 1000);
    // clear code selection
    e.clearSelection();
  });
  function tippyHover(el, contentFn) {
    const config = {
      allowHTML: true,
      content: contentFn,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start'
    };
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      // use id or data attribute instead here
      let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      return note.innerHTML;
    });
  }
      let selectedAnnoteEl;
      const selectorForAnnotation = ( cell, annotation) => {
        let cellAttr = 'data-code-cell="' + cell + '"';
        let lineAttr = 'data-code-annotation="' +  annotation + '"';
        const selector = 'span[' + cellAttr + '][' + lineAttr + ']';
        return selector;
      }
      const selectCodeLines = (annoteEl) => {
        const doc = window.document;
        const targetCell = annoteEl.getAttribute("data-target-cell");
        const targetAnnotation = annoteEl.getAttribute("data-target-annotation");
        const annoteSpan = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
        const lines = annoteSpan.getAttribute("data-code-lines").split(",");
        const lineIds = lines.map((line) => {
          return targetCell + "-" + line;
        })
        let top = null;
        let height = null;
        let parent = null;
        if (lineIds.length > 0) {
            //compute the position of the single el (top and bottom and make a div)
            const el = window.document.getElementById(lineIds[0]);
            top = el.offsetTop;
            height = el.offsetHeight;
            parent = el.parentElement.parentElement;
          if (lineIds.length > 1) {
            const lastEl = window.document.getElementById(lineIds[lineIds.length - 1]);
            const bottom = lastEl.offsetTop + lastEl.offsetHeight;
            height = bottom - top;
          }
          if (top !== null && height !== null && parent !== null) {
            // cook up a div (if necessary) and position it 
            let div = window.document.getElementById("code-annotation-line-highlight");
            if (div === null) {
              div = window.document.createElement("div");
              div.setAttribute("id", "code-annotation-line-highlight");
              div.style.position = 'absolute';
              parent.appendChild(div);
            }
            div.style.top = top - 2 + "px";
            div.style.height = height + 4 + "px";
            let gutterDiv = window.document.getElementById("code-annotation-line-highlight-gutter");
            if (gutterDiv === null) {
              gutterDiv = window.document.createElement("div");
              gutterDiv.setAttribute("id", "code-annotation-line-highlight-gutter");
              gutterDiv.style.position = 'absolute';
              const codeCell = window.document.getElementById(targetCell);
              const gutter = codeCell.querySelector('.code-annotation-gutter');
              gutter.appendChild(gutterDiv);
            }
            gutterDiv.style.top = top - 2 + "px";
            gutterDiv.style.height = height + 4 + "px";
          }
          selectedAnnoteEl = annoteEl;
        }
      };
      const unselectCodeLines = () => {
        const elementsIds = ["code-annotation-line-highlight", "code-annotation-line-highlight-gutter"];
        elementsIds.forEach((elId) => {
          const div = window.document.getElementById(elId);
          if (div) {
            div.remove();
          }
        });
        selectedAnnoteEl = undefined;
      };
      // Attach click handler to the DT
      const annoteDls = window.document.querySelectorAll('dt[data-target-cell]');
      for (const annoteDlNode of annoteDls) {
        annoteDlNode.addEventListener('click', (event) => {
          const clickedEl = event.target;
          if (clickedEl !== selectedAnnoteEl) {
            unselectCodeLines();
            const activeEl = window.document.querySelector('dt[data-target-cell].code-annotation-active');
            if (activeEl) {
              activeEl.classList.remove('code-annotation-active');
            }
            selectCodeLines(clickedEl);
            clickedEl.classList.add('code-annotation-active');
          } else {
            // Unselect the line
            unselectCodeLines();
            clickedEl.classList.remove('code-annotation-active');
          }
        });
      }
  const findCites = (el) => {
    const parentEl = el.parentElement;
    if (parentEl) {
      const cites = parentEl.dataset.cites;
      if (cites) {
        return {
          el,
          cites: cites.split(' ')
        };
      } else {
        return findCites(el.parentElement)
      }
    } else {
      return undefined;
    }
  };
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const citeInfo = findCites(ref);
    if (citeInfo) {
      tippyHover(citeInfo.el, function() {
        var popup = window.document.createElement('div');
        citeInfo.cites.forEach(function(cite) {
          var citeDiv = window.document.createElement('div');
          citeDiv.classList.add('hanging-indent');
          citeDiv.classList.add('csl-entry');
          var biblioDiv = window.document.getElementById('ref-' + cite);
          if (biblioDiv) {
            citeDiv.innerHTML = biblioDiv.innerHTML;
          }
          popup.appendChild(citeDiv);
        });
        return popup.innerHTML;
      });
    }
  }
});
</script><nav class="page-navigation"><div class="nav-page nav-page-previous">
      <a href="../pages/interactions-centric.html" class="pagination-link">
        <i class="bi bi-arrow-left-short"></i> <span class="nav-page-text"><span class="chapter-number">6</span>&nbsp; <span class="chapter-title">Interactions-centric analysis</span></span>
      </a>          
  </div>
  <div class="nav-page nav-page-next">
      <a href="../pages/disseminating.html" class="pagination-link">
        <span class="nav-page-text"><span class="chapter-number">8</span>&nbsp; <span class="chapter-title">Data gateways: accessing public Hi-C data portals</span></span> <i class="bi bi-arrow-right-short"></i>
      </a>
  </div>
</nav>
</div> <!-- /content -->
<footer class="footer"><div class="nav-footer">
    <div class="nav-footer-left"><i>OHCA: Orchestrating Hi-C analysis with Bioconductor</i> was written by J. Serizay</div>   
    <div class="nav-footer-center">
      &nbsp;
    </div>
    <div class="nav-footer-right">This book was built with <a href="https://github.com/js2264/BiocBook/">BiocBook</a> with <span class="emoji" data-emoji="heart">❤️</span></div>
  </div>
</footer>


</body></html>